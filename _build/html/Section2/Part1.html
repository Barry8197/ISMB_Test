
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Section 2: Network Analysis &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Section2/Part1';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction to Graph Neural Networks" href="../Section3_intro.html" />
    <link rel="prev" title="Introduction to Network Analysis" href="../Section2_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    An Introduction to Multi Modal Analysis using Networks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Section1_intro.html">Introduction to Network Basics</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Section1/Part1.html"><font color="darkblue">Retrieval of Protein-Protein Interactions from STRING</font></a></li>








<li class="toctree-l2"><a class="reference internal" href="../Section1/Part2.html">Section 2</a></li>







</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Section2_intro.html">Introduction to Network Analysis</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Section 2: Network Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Section3_intro.html"><font color="darkblue"><u> Introduction to Graph Neural Networks </u></font></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Section3/Part1.html"><font color="darkblue"> Part 1 : Message Passing </font></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Section3/Part2.html"><font color="darkblue"> Part 2 : Problem Formulation / Patient Similarity Network Generation </font></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Section3/Part3.html"><font color="darkblue"> Part 3 : Smoking Network Classification using Graph Convolutional Networks</font></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Section3/Part4.html"><font color="darkblue"> Part 4 : Similarity Network Fusion with Graph Convolutional Networks</font></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ConceptGlossary.html">Concept Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions_definitions.html">CUSTOM FUNCTIONS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Barry8197/ISMB_Test" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Barry8197/ISMB_Test/issues/new?title=Issue%20on%20page%20%2FSection2/Part1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Section2/Part1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Section 2: Network Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-datasets">0. Load Datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#molecular-network-analysis-with-g-exp">1. Molecular Network Analysis with <code class="docutils literal notranslate"><span class="pre">G_exp</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#over-representation-analysis-ora">1.1 Over Representation Analysis (ORA)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ora-before-clustering">1.1.1 ORA before clustering</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ora-after-clustering">1.1.1 ORA after clustering</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gene-set-enrichment-analysis-gsea">1.2 Gene Set Enrichment Analysis (GSEA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gsea-on-clusters">GSEA on clusters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#patient-network-analysis">2. Patient Network Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-on-individual-patient-networks">2.1 Clustering on Individual Patient Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#similarity-network-fusion-snf">2.2 Similarity Network Fusion (SNF)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-gsea-pre-rank-with-dna-methylation-data">Optional: GSEA pre-rank with DNA methylation data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-create-protein-protein-interaction-ppi-network">Optional: Create Protein-Protein Interaction (PPI) Network</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-ppi-data-from-stringdb">Retrieve PPI data from StringDB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-ppi-network">Create PPI Network</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="section-2-network-analysis">
<h1>Section 2: Network Analysis<a class="headerlink" href="#section-2-network-analysis" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">urllib</span> <span class="k">as</span> <span class="nn">ul</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">from</span> <span class="nn">prettytable</span> <span class="kn">import</span> <span class="n">PrettyTable</span>
<span class="kn">import</span> <span class="nn">gseapy</span> <span class="k">as</span> <span class="nn">gp</span>
<span class="kn">from</span> <span class="nn">palettable</span> <span class="kn">import</span> <span class="n">wesanderson</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;frozen importlib._bootstrap&gt;:228: RuntimeWarning: scipy._lib.messagestream.MessageStream size changed, may indicate binary incompatibility. Expected 56 from C header, got 64 from PyObject
</pre></div>
</div>
</div>
</div>
<section id="load-datasets">
<h2>0. Load Datasets<a class="headerlink" href="#load-datasets" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Three networks from Section 1.</p>
<ul>
<li><p>Gene correlation network</p></li>
<li><p>Patient network from TCGA gene expression data</p></li>
<li><p>Patient network from TCGA DNA methylation data</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Barry\OneDrive - University of Edinburgh\PhD_Research\Year2\Python\ismb_jupyterbook\ISMB_Test\Section2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_patient_gxp_path</span> <span class="o">=</span> <span class="s1">&#39;section2_data/section1_networks/patient_coexpression_network.gml&#39;</span>
<span class="n">G_patient_dnam_path</span> <span class="o">=</span> <span class="s1">&#39;section2_data/section1_networks/patient_meth_network.gml&#39;</span>
<span class="n">G_gxp_path</span> <span class="o">=</span> <span class="s1">&#39;section2_data/section1_networks/gene_coexpression_network.gml&#39;</span> 

<span class="c1"># Load the GML graphs</span>
<span class="n">G_gxp</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="n">G_gxp_path</span><span class="p">)</span>
<span class="n">G_patient_gxp</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="n">G_patient_gxp_path</span><span class="p">)</span>
<span class="n">G_patient_dnam</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="n">G_patient_dnam_path</span><span class="p">)</span>

<span class="c1"># Get all nodes in the graph</span>
<span class="n">G_gxp_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G_gxp</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
<span class="n">G_patient_gxp_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G_patient_gxp</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
<span class="n">G_patient_dnam_nodes_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G_patient_dnam</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>

<span class="c1"># Load raw TCGA datasets</span>
<span class="n">tcga_dnam_path</span> <span class="o">=</span> <span class="s1">&#39;section2_data/ISMB_TCGA_DNAm.pkl&#39;</span> 

<span class="n">tcga_gxp_path</span> <span class="o">=</span> <span class="s1">&#39;section2_data/ISMB_TCGA_GE.pkl&#39;</span>
<span class="n">tcga_gxp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">tcga_gxp_path</span><span class="p">)</span>

<span class="c1"># tcga_gxp_df = tcga_gxp[&#39;datExpr&#39;]</span>
<span class="n">tcga_gxp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;section2_data/tcga_ge_df_symbols_t.csv&#39;</span><span class="p">)</span> <span class="c1"># dataset with gene symbols </span>
<span class="n">tcga_gxp_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;GENES&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tcqa_gxp_meta</span> <span class="o">=</span> <span class="n">tcga_gxp</span><span class="p">[</span><span class="s1">&#39;datMeta&#39;</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_gxp_nodes_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_patient_gxp_nodes_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_patient_dnam_nodes_list</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">Input In [3],</span> in <span class="ni">&lt;cell line: 6&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">G_gxp_path</span> <span class="o">=</span> <span class="s1">&#39;section2_data/section1_networks/gene_coexpression_network.gml&#39;</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># Load the GML graphs</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">G_gxp</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="n">G_gxp_path</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">G_patient_gxp</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="n">G_patient_gxp_path</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">G_patient_dnam</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="n">G_patient_dnam_path</span><span class="p">)</span>

<span class="nn">File ~\anaconda3\lib\site-packages\networkx\utils\decorators.py:770,</span> in <span class="ni">argmap.__call__.&lt;locals&gt;.func</span><span class="nt">(_argmap__wrapper, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">769</span> <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">__wrapper</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">770</span>     <span class="k">return</span> <span class="n">argmap</span><span class="o">.</span><span class="n">_lazy_compile</span><span class="p">(</span><span class="n">__wrapper</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File &lt;class &#39;networkx.utils.decorators.argmap&#39;&gt; compilation 5:3,</span> in <span class="ni">argmap_read_gml_1</span><span class="nt">(path, label, destringizer, backend, **backend_kwargs)</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">bz2</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">collections</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">gzip</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">inspect</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">itertools</span>

<span class="nn">File ~\anaconda3\lib\site-packages\networkx\utils\decorators.py:193,</span> in <span class="ni">open_file.&lt;locals&gt;._open_file</span><span class="nt">(path)</span>
<span class="g g-Whitespace">    </span><span class="mi">189</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">190</span>     <span class="c1"># could be None, or a file handle, in which case the algorithm will deal with it</span>
<span class="g g-Whitespace">    </span><span class="mi">191</span>     <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">193</span> <span class="n">fobj</span> <span class="o">=</span> <span class="n">_dispatch_dict</span><span class="p">[</span><span class="n">ext</span><span class="p">](</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">194</span> <span class="k">return</span> <span class="n">fobj</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">fobj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;section2_data/section1_networks/gene_coexpression_network.gml&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for overlapping nodes between the patient networks</span>
<span class="n">overlap</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">G_patient_gxp_nodes_list</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">G_patient_dnam_nodes_list</span><span class="p">))</span>

<span class="c1"># Get the number of overlapping nodes</span>
<span class="n">num_overlap</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">overlap</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">num_overlap</span><span class="si">}</span><span class="s2"> overlapping nodes between patient networks&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>232 overlapping nodes between patient networks
</pre></div>
</div>
</div>
</div>
</section>
<section id="molecular-network-analysis-with-g-exp">
<h2>1. Molecular Network Analysis with <code class="docutils literal notranslate"><span class="pre">G_exp</span></code><a class="headerlink" href="#molecular-network-analysis-with-g-exp" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gene_sets</span> <span class="o">=</span> <span class="s1">&#39;KEGG_2021_Human&#39;</span> <span class="c1"># &#39;MSigDB_Hallmark_2020&#39; </span>
</pre></div>
</div>
</div>
</div>
<section id="over-representation-analysis-ora">
<h3>1.1 Over Representation Analysis (ORA)<a class="headerlink" href="#over-representation-analysis-ora" title="Link to this heading">#</a></h3>
<section id="ora-before-clustering">
<h4>1.1.1 ORA before clustering<a class="headerlink" href="#ora-before-clustering" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">enr_all_nodes</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">enrichr</span><span class="p">(</span><span class="n">gene_list</span><span class="o">=</span><span class="n">G_gxp_nodes_list</span><span class="p">,</span> <span class="n">gene_sets</span><span class="o">=</span><span class="p">[</span><span class="n">gene_sets</span><span class="p">],</span> <span class="n">organism</span><span class="o">=</span><span class="s1">&#39;human&#39;</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">enr_all_nodes</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gene_set</th>
      <th>Term</th>
      <th>Overlap</th>
      <th>P-value</th>
      <th>Adjusted P-value</th>
      <th>Old P-value</th>
      <th>Old Adjusted P-value</th>
      <th>Odds Ratio</th>
      <th>Combined Score</th>
      <th>Genes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>KEGG_2021_Human</td>
      <td>Cell adhesion molecules</td>
      <td>32/148</td>
      <td>4.963642e-28</td>
      <td>9.778376e-26</td>
      <td>0</td>
      <td>0</td>
      <td>20.158518</td>
      <td>1267.370905</td>
      <td>CD86;ITGAM;SELPLG;ITGB2;ITGAL;SPN;CDH5;HLA-DMA;HLA-DMB;HLA-DOA;CD34;HLA-DQA1;HLA-DPA1;HLA-DRB5;ITGA4;HLA-B;HLA-C;HLA-A;HLA-F;CD2;VCAN;CD4;PTPRC;CD6;CD8A;ITGA8;PECAM1;HLA-DPB1;HLA-DRA;SIGLEC1;HLA-DRB1;HLA-DQB1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>KEGG_2021_Human</td>
      <td>Phagosome</td>
      <td>29/152</td>
      <td>7.718499e-24</td>
      <td>7.602722e-22</td>
      <td>0</td>
      <td>0</td>
      <td>17.032160</td>
      <td>906.424701</td>
      <td>ITGAM;NCF2;NCF4;ITGB2;THBS2;CORO1A;FCGR3A;HLA-DMA;HLA-DMB;MRC1;CD14;HLA-DOA;HLA-DQA1;HLA-DPA1;MSR1;HLA-DRB5;HLA-B;CYBB;HLA-C;TAP1;HLA-A;HLA-F;MARCO;FCGR2A;HLA-DPB1;HLA-DRA;TLR4;HLA-DRB1;HLA-DQB1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>KEGG_2021_Human</td>
      <td>Staphylococcus aureus infection</td>
      <td>24/95</td>
      <td>5.021667e-23</td>
      <td>3.297562e-21</td>
      <td>0</td>
      <td>0</td>
      <td>24.040416</td>
      <td>1234.371891</td>
      <td>C1QB;C1QA;HLA-DRB5;ITGAM;SELPLG;ITGB2;C5AR1;PTAFR;FPR1;FPR3;ITGAL;FCGR3A;HLA-DMA;HLA-DMB;FCGR2A;C3AR1;HLA-DPB1;HLA-DRA;HLA-DOA;HLA-DQA1;HLA-DRB1;HLA-DPA1;HLA-DQB1;C1QC</td>
    </tr>
    <tr>
      <th>3</th>
      <td>KEGG_2021_Human</td>
      <td>Leishmaniasis</td>
      <td>21/77</td>
      <td>4.634501e-21</td>
      <td>2.282492e-19</td>
      <td>0</td>
      <td>0</td>
      <td>26.403226</td>
      <td>1236.219058</td>
      <td>HLA-DRB5;ITGAM;ITGA4;NCF2;PRKCB;STAT1;ITGB2;NCF4;CYBB;FCGR3A;HLA-DMA;HLA-DMB;FCGR2A;HLA-DPB1;HLA-DRA;HLA-DOA;TLR4;HLA-DQA1;HLA-DRB1;HLA-DPA1;HLA-DQB1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>KEGG_2021_Human</td>
      <td>Viral myocarditis</td>
      <td>18/60</td>
      <td>4.647925e-19</td>
      <td>1.831283e-17</td>
      <td>0</td>
      <td>0</td>
      <td>29.875380</td>
      <td>1261.120325</td>
      <td>CD86;HLA-DRB5;LAMA2;ITGB2;HLA-B;HLA-C;HLA-A;ITGAL;HLA-F;HLA-DMA;HLA-DMB;HLA-DPB1;HLA-DRA;HLA-DOA;HLA-DQA1;HLA-DRB1;HLA-DPA1;HLA-DQB1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>KEGG_2021_Human</td>
      <td>Hematopoietic cell lineage</td>
      <td>21/99</td>
      <td>1.392113e-18</td>
      <td>4.570771e-17</td>
      <td>0</td>
      <td>0</td>
      <td>18.934932</td>
      <td>778.523171</td>
      <td>CSF1R;HLA-DRB5;ITGAM;ITGA4;CD3E;CD2;HLA-DMA;CD4;HLA-DMB;CD8A;HLA-DPB1;HLA-DRA;CD37;CD14;HLA-DOA;IL7R;CD34;HLA-DQA1;HLA-DRB1;HLA-DPA1;HLA-DQB1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>KEGG_2021_Human</td>
      <td>Allograft rejection</td>
      <td>15/38</td>
      <td>3.498581e-18</td>
      <td>9.846007e-17</td>
      <td>0</td>
      <td>0</td>
      <td>45.027460</td>
      <td>1809.841566</td>
      <td>CD86;HLA-DRB5;HLA-B;HLA-C;HLA-A;HLA-F;HLA-DMA;HLA-DMB;HLA-DPB1;HLA-DRA;HLA-DOA;HLA-DQA1;HLA-DRB1;HLA-DPA1;HLA-DQB1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>KEGG_2021_Human</td>
      <td>Graft-versus-host disease</td>
      <td>15/42</td>
      <td>2.114525e-17</td>
      <td>5.207019e-16</td>
      <td>0</td>
      <td>0</td>
      <td>38.348928</td>
      <td>1472.411543</td>
      <td>CD86;HLA-DRB5;HLA-B;HLA-C;HLA-A;HLA-F;HLA-DMA;HLA-DMB;HLA-DPB1;HLA-DRA;HLA-DOA;HLA-DQA1;HLA-DRB1;HLA-DPA1;HLA-DQB1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>KEGG_2021_Human</td>
      <td>Type I diabetes mellitus</td>
      <td>15/43</td>
      <td>3.203949e-17</td>
      <td>7.013088e-16</td>
      <td>0</td>
      <td>0</td>
      <td>36.977444</td>
      <td>1404.387131</td>
      <td>CD86;HLA-DRB5;HLA-B;HLA-C;HLA-A;HLA-F;HLA-DMA;HLA-DMB;HLA-DPB1;HLA-DRA;HLA-DOA;HLA-DQA1;HLA-DRB1;HLA-DPA1;HLA-DQB1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>KEGG_2021_Human</td>
      <td>Antigen processing and presentation</td>
      <td>18/78</td>
      <td>8.383314e-17</td>
      <td>1.651513e-15</td>
      <td>0</td>
      <td>0</td>
      <td>20.893617</td>
      <td>773.433715</td>
      <td>CD74;HLA-DRB5;HLA-B;HLA-C;TAP1;HLA-A;HLA-F;HLA-DMA;CD4;HLA-DMB;CD8A;HLA-DPB1;HLA-DRA;HLA-DOA;HLA-DQA1;HLA-DRB1;HLA-DPA1;HLA-DQB1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="ora-after-clustering">
<h4>1.1.1 ORA after clustering<a class="headerlink" href="#ora-after-clustering" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (Add other clustering methods introduced in Section 1)</span>
<span class="n">communities</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">community</span><span class="o">.</span><span class="n">modularity_max</span><span class="o">.</span><span class="n">greedy_modularity_communities</span><span class="p">(</span><span class="n">G_gxp</span><span class="p">)</span>

<span class="c1"># Print out the number of communities</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The network has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">communities</span><span class="p">)</span><span class="si">}</span><span class="s1"> communities.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Create sub-grpahs of each community</span>
<span class="n">subgraphs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">community</span> <span class="ow">in</span> <span class="n">communities</span><span class="p">:</span>
    <span class="n">subgraphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G_gxp</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">community</span><span class="p">))</span>
    
<span class="c1"># Print out the number of nodes in each community</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">subgraph</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subgraphs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Community </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> has </span><span class="si">{</span><span class="n">subgraph</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span><span class="si">}</span><span class="s1"> nodes.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The network has 6 communities.

Community 1 has 101 nodes.
Community 2 has 67 nodes.
Community 3 has 64 nodes.
Community 4 has 51 nodes.
Community 5 has 15 nodes.
Community 6 has 2 nodes.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Patch</span>

<span class="k">def</span> <span class="nf">draw_communities</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">communities</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">,</span> <span class="n">cmap_name</span><span class="o">=</span><span class="s1">&#39;tab20&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draws the graph G with nodes colored by community memberships and includes a legend indicating community index.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">G</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The graph is empty or not defined.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">communities</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Communities list is empty or not defined.&quot;</span><span class="p">)</span>

    <span class="c1"># Create a dict with the node as key and community index as value</span>
    <span class="n">community_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">community</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">communities</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">community</span><span class="p">}</span>

    <span class="c1"># Determine number of communities and set up colors</span>
    <span class="n">num_communities</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">communities</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">)</span>
    <span class="n">community_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">num_communities</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_communities</span><span class="p">)]</span>
    <span class="n">node_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">community_colors</span><span class="p">[</span><span class="n">community_dict</span><span class="p">[</span><span class="n">node</span><span class="p">]]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>

    <span class="c1"># Set up the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">layout</span><span class="si">}</span><span class="s1">_layout&#39;</span><span class="p">)(</span><span class="n">G</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">layout</span><span class="si">}</span><span class="s1">_layout&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="c1"># Draw the graph</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Create a legend</span>
    <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">community_colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Community </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_communities</span><span class="p">)]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Communities&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">draw_communities</span><span class="p">(</span><span class="n">G_gxp</span><span class="p">,</span> <span class="n">communities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f3e046215d045822f7640c922b5e0dc9730496b376ae1463df1497e339167a28.png" src="../_images/f3e046215d045822f7640c922b5e0dc9730496b376ae1463df1497e339167a28.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">communityORA</span><span class="p">(</span><span class="n">genes</span><span class="p">):</span>
    <span class="n">enr</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">enrichr</span><span class="p">(</span><span class="n">gene_list</span><span class="o">=</span><span class="n">genes</span><span class="p">,</span> 
                     <span class="n">gene_sets</span><span class="o">=</span><span class="p">[</span><span class="n">gene_sets</span><span class="p">],</span>
                     <span class="n">organism</span><span class="o">=</span><span class="s1">&#39;human&#39;</span><span class="p">,</span> 
                     <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Do not write to disk</span>
                     <span class="p">)</span>
    <span class="k">return</span> <span class="n">enr</span>

<span class="n">communities</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">community</span><span class="p">)</span> <span class="k">for</span> <span class="n">community</span> <span class="ow">in</span> <span class="n">communities</span><span class="p">]</span>

<span class="c1"># Perform ORA for three communities</span>
<span class="n">community1_enr</span> <span class="o">=</span> <span class="n">communityORA</span><span class="p">(</span><span class="n">communities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">community2_enr</span> <span class="o">=</span> <span class="n">communityORA</span><span class="p">(</span><span class="n">communities</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">community3_enr</span> <span class="o">=</span> <span class="n">communityORA</span><span class="p">(</span><span class="n">communities</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Print the top 10 results for each community</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">()</span>
<span class="n">x</span><span class="o">.</span><span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Community 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Community 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Community 3&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="n">community1_enr</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;Term&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">community2_enr</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;Term&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">community3_enr</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;Term&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------+------------------------------------------------------+-------------------------------------------------+
|                 Community 1                  |                     Community 2                      |                   Community 3                   |
+----------------------------------------------+------------------------------------------------------+-------------------------------------------------+
|       Staphylococcus aureus infection        |           Protein digestion and absorption           |             Cell adhesion molecules             |
|                  Phagosome                   |                    Focal adhesion                    |       Complement and coagulation cascades       |
|                Leishmaniasis                 |               ECM-receptor interaction               |             ECM-receptor interaction            |
|                 Tuberculosis                 |              Relaxin signaling pathway               |                  Focal adhesion                 |
|             Rheumatoid arthritis             |              PI3K-Akt signaling pathway              |          Human papillomavirus infection         |
|                    Asthma                    | AGE-RAGE signaling pathway in diabetic complications |               Tyrosine metabolism               |
|         Systemic lupus erythematosus         |                      Amoebiasis                      |        Vascular smooth muscle contraction       |
| Intestinal immune network for IgA production |            Human papillomavirus infection            |     Neuroactive ligand-receptor interaction     |
|           Cell adhesion molecules            |          Vascular smooth muscle contraction          | Arrhythmogenic right ventricular cardiomyopathy |
|             Allograft rejection              |               Proteoglycans in cancer                |            PI3K-Akt signaling pathway           |
+----------------------------------------------+------------------------------------------------------+-------------------------------------------------+
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="gene-set-enrichment-analysis-gsea">
<h3>1.2 Gene Set Enrichment Analysis (GSEA)<a class="headerlink" href="#gene-set-enrichment-analysis-gsea" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tcga_gxp_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TCGA-38-7271</th>
      <th>TCGA-55-7914</th>
      <th>TCGA-95-7043</th>
      <th>TCGA-73-4658</th>
      <th>TCGA-86-8076</th>
      <th>TCGA-55-7726</th>
      <th>TCGA-44-6147</th>
      <th>TCGA-50-5932</th>
      <th>TCGA-44-2661</th>
      <th>TCGA-86-7954</th>
      <th>TCGA-73-4662</th>
      <th>TCGA-44-7671</th>
      <th>TCGA-78-8660</th>
      <th>TCGA-62-A46P</th>
      <th>TCGA-55-6978</th>
      <th>TCGA-50-6592</th>
      <th>TCGA-38-4625</th>
      <th>TCGA-80-5611</th>
      <th>TCGA-86-8054</th>
      <th>TCGA-55-6986</th>
      <th>TCGA-L9-A5IP</th>
      <th>TCGA-69-7764</th>
      <th>TCGA-49-6744</th>
      <th>TCGA-75-5125</th>
      <th>TCGA-38-4626</th>
      <th>TCGA-69-7763</th>
      <th>TCGA-86-8279</th>
      <th>TCGA-93-8067</th>
      <th>TCGA-97-8179</th>
      <th>TCGA-55-A48Y</th>
      <th>TCGA-86-8055</th>
      <th>TCGA-91-6835</th>
      <th>TCGA-55-6982</th>
      <th>TCGA-55-A4DF</th>
      <th>TCGA-44-6774</th>
      <th>TCGA-50-5066</th>
      <th>TCGA-05-5423</th>
      <th>TCGA-67-3774</th>
      <th>TCGA-97-A4M2</th>
      <th>TCGA-95-7567</th>
      <th>TCGA-49-AAR0</th>
      <th>TCGA-44-2656</th>
      <th>TCGA-53-7813</th>
      <th>TCGA-O1-A52J</th>
      <th>TCGA-35-4122</th>
      <th>TCGA-55-8092</th>
      <th>TCGA-49-6761</th>
      <th>TCGA-49-4507</th>
      <th>TCGA-55-7816</th>
      <th>TCGA-78-7145</th>
      <th>TCGA-55-6983</th>
      <th>TCGA-53-7624</th>
      <th>TCGA-97-A4M3</th>
      <th>TCGA-50-5068</th>
      <th>TCGA-78-8648</th>
      <th>TCGA-44-6778</th>
      <th>TCGA-80-5608</th>
      <th>TCGA-86-8281</th>
      <th>TCGA-MP-A4T6</th>
      <th>TCGA-55-8085</th>
      <th>TCGA-62-8399</th>
      <th>TCGA-97-A4M5</th>
      <th>TCGA-97-7547</th>
      <th>TCGA-05-5429</th>
      <th>TCGA-55-7994</th>
      <th>TCGA-55-8094</th>
      <th>TCGA-05-4425</th>
      <th>TCGA-44-4112</th>
      <th>TCGA-49-6767</th>
      <th>TCGA-49-4490</th>
      <th>TCGA-MP-A4T9</th>
      <th>TCGA-50-5942</th>
      <th>TCGA-MP-A4SV</th>
      <th>TCGA-49-AAR4</th>
      <th>TCGA-05-4397</th>
      <th>TCGA-44-A47A</th>
      <th>TCGA-86-8359</th>
      <th>TCGA-78-7539</th>
      <th>TCGA-MP-A4T8</th>
      <th>TCGA-99-8032</th>
      <th>TCGA-50-6595</th>
      <th>TCGA-55-6968</th>
      <th>TCGA-44-8120</th>
      <th>TCGA-55-8302</th>
      <th>TCGA-99-8025</th>
      <th>TCGA-64-1679</th>
      <th>TCGA-95-8039</th>
      <th>TCGA-44-A479</th>
      <th>TCGA-44-6148</th>
      <th>TCGA-NJ-A55O</th>
      <th>TCGA-MP-A5C7</th>
      <th>TCGA-64-5778</th>
      <th>TCGA-55-6971</th>
      <th>TCGA-49-AARN</th>
      <th>TCGA-44-A47B</th>
      <th>TCGA-55-5899</th>
      <th>TCGA-49-AAQV</th>
      <th>TCGA-99-8028</th>
      <th>TCGA-75-6205</th>
      <th>TCGA-97-8552</th>
      <th>TCGA-50-8459</th>
      <th>TCGA-05-5425</th>
      <th>TCGA-78-7150</th>
      <th>TCGA-86-A4P7</th>
      <th>TCGA-49-4512</th>
      <th>TCGA-55-8206</th>
      <th>TCGA-55-8614</th>
      <th>TCGA-64-5815</th>
      <th>TCGA-L9-A50W</th>
      <th>TCGA-73-4675</th>
      <th>TCGA-55-7995</th>
      <th>TCGA-05-4433</th>
      <th>TCGA-55-7727</th>
      <th>TCGA-44-2668</th>
      <th>TCGA-44-A4SU</th>
      <th>TCGA-55-7907</th>
      <th>TCGA-69-7765</th>
      <th>TCGA-49-4487</th>
      <th>TCGA-44-2662</th>
      <th>TCGA-67-6216</th>
      <th>TCGA-55-7283</th>
      <th>TCGA-86-8280</th>
      <th>TCGA-91-6840</th>
      <th>TCGA-78-7154</th>
      <th>TCGA-49-4488</th>
      <th>TCGA-93-7348</th>
      <th>TCGA-62-A470</th>
      <th>TCGA-78-7147</th>
      <th>TCGA-50-5936</th>
      <th>TCGA-55-6984</th>
      <th>TCGA-50-5941</th>
      <th>TCGA-69-7978</th>
      <th>TCGA-78-7220</th>
      <th>TCGA-55-8616</th>
      <th>TCGA-44-A4SS</th>
      <th>TCGA-55-7570</th>
      <th>TCGA-78-7146</th>
      <th>TCGA-44-3398</th>
      <th>TCGA-05-5420</th>
      <th>TCGA-50-5072</th>
      <th>TCGA-05-4396</th>
      <th>TCGA-05-4405</th>
      <th>TCGA-50-5935</th>
      <th>TCGA-38-4629</th>
      <th>TCGA-55-8619</th>
      <th>TCGA-05-4410</th>
      <th>TCGA-73-4676</th>
      <th>TCGA-97-8172</th>
      <th>TCGA-44-7661</th>
      <th>TCGA-05-4384</th>
      <th>TCGA-44-2655</th>
      <th>TCGA-80-5607</th>
      <th>TCGA-67-3770</th>
      <th>TCGA-91-6836</th>
      <th>TCGA-95-7562</th>
      <th>TCGA-55-8511</th>
      <th>TCGA-44-6776</th>
      <th>TCGA-95-7948</th>
      <th>TCGA-91-7771</th>
      <th>TCGA-50-5944</th>
      <th>TCGA-MN-A4N5</th>
      <th>TCGA-73-4677</th>
      <th>TCGA-78-7540</th>
      <th>TCGA-91-6829</th>
      <th>TCGA-78-8640</th>
      <th>TCGA-62-8398</th>
      <th>TCGA-55-8512</th>
      <th>TCGA-83-5908</th>
      <th>TCGA-55-6987</th>
      <th>TCGA-93-A4JP</th>
      <th>TCGA-73-A9RS</th>
      <th>TCGA-L4-A4E5</th>
      <th>TCGA-86-8074</th>
      <th>TCGA-86-8358</th>
      <th>TCGA-78-7158</th>
      <th>TCGA-91-8497</th>
      <th>TCGA-49-AARO</th>
      <th>TCGA-78-7159</th>
      <th>TCGA-55-7227</th>
      <th>TCGA-86-7714</th>
      <th>TCGA-L9-A7SV</th>
      <th>TCGA-78-7143</th>
      <th>TCGA-91-8499</th>
      <th>TCGA-49-AAR3</th>
      <th>TCGA-55-8620</th>
      <th>TCGA-69-8255</th>
      <th>TCGA-75-6207</th>
      <th>TCGA-62-A46Y</th>
      <th>TCGA-NJ-A4YF</th>
      <th>TCGA-91-6830</th>
      <th>TCGA-62-8395</th>
      <th>TCGA-49-4486</th>
      <th>TCGA-44-6145</th>
      <th>TCGA-86-A4P8</th>
      <th>TCGA-78-7537</th>
      <th>TCGA-44-3919</th>
      <th>TCGA-35-4123</th>
      <th>TCGA-62-8394</th>
      <th>TCGA-69-7761</th>
      <th>TCGA-62-A46U</th>
      <th>TCGA-97-8547</th>
      <th>TCGA-97-7554</th>
      <th>TCGA-50-6673</th>
      <th>TCGA-95-7039</th>
      <th>TCGA-95-7944</th>
      <th>TCGA-55-8301</th>
      <th>TCGA-78-7152</th>
      <th>TCGA-05-4390</th>
      <th>TCGA-44-7659</th>
      <th>TCGA-97-7941</th>
      <th>TCGA-49-4514</th>
      <th>TCGA-55-A490</th>
      <th>TCGA-55-8508</th>
      <th>TCGA-MP-A4TE</th>
      <th>TCGA-97-A4M1</th>
      <th>TCGA-75-6206</th>
      <th>TCGA-86-8671</th>
      <th>TCGA-78-7160</th>
      <th>TCGA-64-1681</th>
      <th>TCGA-49-4494</th>
      <th>TCGA-50-5946</th>
      <th>TCGA-55-7913</th>
      <th>TCGA-44-6779</th>
      <th>TCGA-49-AARE</th>
      <th>TCGA-05-4403</th>
      <th>TCGA-99-AA5R</th>
      <th>TCGA-73-4659</th>
      <th>TCGA-50-8457</th>
      <th>TCGA-75-5147</th>
      <th>TCGA-55-8507</th>
      <th>TCGA-78-7536</th>
      <th>TCGA-95-A4VK</th>
      <th>TCGA-38-4627</th>
      <th>TCGA-67-6215</th>
      <th>TCGA-69-7973</th>
      <th>TCGA-05-5715</th>
      <th>TCGA-75-7030</th>
      <th>TCGA-44-2666</th>
      <th>TCGA-62-A472</th>
      <th>TCGA-55-6985</th>
      <th>TCGA-J2-A4AG</th>
      <th>TCGA-97-A4LX</th>
      <th>TCGA-55-6543</th>
      <th>TCGA-97-7938</th>
      <th>TCGA-35-3615</th>
      <th>TCGA-44-2657</th>
      <th>TCGA-55-8505</th>
      <th>TCGA-97-8175</th>
      <th>TCGA-49-4510</th>
      <th>TCGA-MP-A4TK</th>
      <th>TCGA-50-5044</th>
      <th>TCGA-49-AAR2</th>
      <th>TCGA-05-4250</th>
      <th>TCGA-97-7937</th>
      <th>TCGA-64-5774</th>
      <th>TCGA-86-8674</th>
      <th>TCGA-50-6590</th>
      <th>TCGA-64-5779</th>
      <th>TCGA-75-5146</th>
      <th>TCGA-44-6144</th>
      <th>TCGA-78-8662</th>
      <th>TCGA-55-7911</th>
      <th>TCGA-86-8585</th>
      <th>TCGA-38-A44F</th>
      <th>TCGA-64-1680</th>
      <th>TCGA-97-A4M6</th>
      <th>TCGA-75-6214</th>
      <th>TCGA-55-6980</th>
      <th>TCGA-97-7553</th>
      <th>TCGA-55-A48X</th>
      <th>TCGA-64-1677</th>
      <th>TCGA-73-7498</th>
      <th>TCGA-38-6178</th>
      <th>TCGA-44-7670</th>
      <th>TCGA-62-A471</th>
      <th>TCGA-49-4505</th>
      <th>TCGA-NJ-A7XG</th>
      <th>TCGA-55-6981</th>
      <th>TCGA-91-6848</th>
      <th>TCGA-55-8090</th>
      <th>TCGA-55-7725</th>
      <th>TCGA-55-8207</th>
      <th>TCGA-44-6146</th>
      <th>TCGA-05-4434</th>
      <th>TCGA-55-6979</th>
      <th>TCGA-05-4427</th>
      <th>TCGA-55-8615</th>
      <th>TCGA-50-5939</th>
      <th>TCGA-05-4418</th>
      <th>TCGA-67-6217</th>
      <th>TCGA-49-6745</th>
      <th>TCGA-55-1595</th>
      <th>TCGA-49-6742</th>
      <th>TCGA-05-4402</th>
      <th>TCGA-05-4382</th>
      <th>TCGA-55-7576</th>
      <th>TCGA-67-3773</th>
      <th>TCGA-78-7633</th>
      <th>TCGA-50-6597</th>
      <th>TCGA-44-2659</th>
      <th>TCGA-95-7947</th>
      <th>TCGA-55-7724</th>
      <th>TCGA-J2-A4AD</th>
      <th>TCGA-55-8091</th>
      <th>TCGA-55-1592</th>
      <th>TCGA-73-4670</th>
      <th>TCGA-55-1594</th>
      <th>TCGA-55-8621</th>
      <th>TCGA-50-5051</th>
      <th>TCGA-49-4501</th>
      <th>TCGA-J2-8194</th>
      <th>TCGA-44-8119</th>
      <th>TCGA-55-8203</th>
      <th>TCGA-97-8177</th>
      <th>TCGA-55-7573</th>
      <th>TCGA-55-8089</th>
      <th>TCGA-38-4630</th>
      <th>TCGA-78-7166</th>
      <th>TCGA-38-4631</th>
      <th>TCGA-55-1596</th>
      <th>TCGA-91-A4BD</th>
      <th>TCGA-67-3771</th>
      <th>TCGA-J2-8192</th>
      <th>TCGA-55-A48Z</th>
      <th>TCGA-97-8176</th>
      <th>TCGA-86-6851</th>
      <th>TCGA-50-5931</th>
      <th>TCGA-NJ-A4YI</th>
      <th>TCGA-97-7552</th>
      <th>TCGA-MP-A4T4</th>
      <th>TCGA-L4-A4E6</th>
      <th>TCGA-44-5643</th>
      <th>TCGA-MP-A4TD</th>
      <th>TCGA-05-4244</th>
      <th>TCGA-50-5930</th>
      <th>TCGA-44-6777</th>
      <th>TCGA-05-4430</th>
      <th>TCGA-05-4426</th>
      <th>TCGA-44-6775</th>
      <th>TCGA-05-4420</th>
      <th>TCGA-55-8506</th>
      <th>TCGA-44-7672</th>
      <th>TCGA-62-8402</th>
      <th>TCGA-86-8056</th>
      <th>TCGA-05-4422</th>
      <th>TCGA-75-7027</th>
      <th>TCGA-78-7535</th>
      <th>TCGA-50-8460</th>
      <th>TCGA-75-7031</th>
      <th>TCGA-L9-A444</th>
      <th>TCGA-73-4666</th>
      <th>TCGA-86-7953</th>
      <th>TCGA-86-A4D0</th>
      <th>TCGA-NJ-A4YQ</th>
      <th>TCGA-91-8496</th>
      <th>TCGA-67-3772</th>
      <th>TCGA-55-7281</th>
      <th>TCGA-05-4424</th>
      <th>TCGA-69-A59K</th>
      <th>TCGA-75-7025</th>
      <th>TCGA-55-8514</th>
      <th>TCGA-95-8494</th>
      <th>TCGA-05-4395</th>
      <th>TCGA-93-A4JQ</th>
      <th>TCGA-44-8117</th>
      <th>TCGA-55-8204</th>
      <th>TCGA-50-5933</th>
      <th>TCGA-MN-A4N1</th>
      <th>TCGA-55-7903</th>
      <th>TCGA-86-8669</th>
      <th>TCGA-55-6970</th>
      <th>TCGA-50-6594</th>
      <th>TCGA-86-8075</th>
      <th>TCGA-MP-A4TF</th>
      <th>TCGA-69-7760</th>
      <th>TCGA-78-7161</th>
      <th>TCGA-91-6849</th>
      <th>TCGA-99-8033</th>
      <th>TCGA-55-8205</th>
      <th>TCGA-55-8510</th>
      <th>TCGA-91-6828</th>
      <th>TCGA-50-5049</th>
      <th>TCGA-99-7458</th>
      <th>TCGA-49-AARR</th>
      <th>TCGA-MP-A4TC</th>
      <th>TCGA-49-AARQ</th>
      <th>TCGA-93-A4JN</th>
      <th>TCGA-95-A4VP</th>
      <th>TCGA-69-8453</th>
      <th>TCGA-55-8513</th>
      <th>TCGA-55-6975</th>
      <th>TCGA-86-8278</th>
      <th>TCGA-75-6203</th>
      <th>TCGA-49-6743</th>
      <th>TCGA-55-7574</th>
      <th>TCGA-78-8655</th>
      <th>TCGA-05-4389</th>
      <th>TCGA-86-7701</th>
      <th>TCGA-91-6831</th>
      <th>TCGA-55-7728</th>
      <th>TCGA-97-A4M0</th>
      <th>TCGA-50-6593</th>
      <th>TCGA-86-6562</th>
      <th>TCGA-62-A46S</th>
      <th>TCGA-86-A4JF</th>
      <th>TCGA-J2-A4AE</th>
      <th>TCGA-55-8087</th>
      <th>TCGA-78-7542</th>
      <th>TCGA-78-7148</th>
      <th>TCGA-55-A493</th>
      <th>TCGA-91-A4BC</th>
      <th>TCGA-05-4432</th>
      <th>TCGA-55-6712</th>
      <th>TCGA-4B-A93V</th>
      <th>TCGA-93-7347</th>
      <th>TCGA-86-8668</th>
      <th>TCGA-MP-A4TI</th>
      <th>TCGA-69-8254</th>
      <th>TCGA-64-1676</th>
      <th>TCGA-62-A46V</th>
      <th>TCGA-78-7167</th>
      <th>TCGA-55-7284</th>
      <th>TCGA-78-7162</th>
      <th>TCGA-75-6212</th>
      <th>TCGA-97-7546</th>
      <th>TCGA-44-5644</th>
      <th>TCGA-55-8299</th>
      <th>TCGA-75-6211</th>
      <th>TCGA-MP-A4SW</th>
      <th>TCGA-78-7149</th>
      <th>TCGA-S2-AA1A</th>
      <th>TCGA-95-A4VN</th>
      <th>TCGA-55-8096</th>
      <th>TCGA-05-4398</th>
      <th>TCGA-97-8171</th>
      <th>TCGA-55-A492</th>
      <th>TCGA-71-8520</th>
      <th>TCGA-44-3396</th>
      <th>TCGA-55-A57B</th>
      <th>TCGA-L9-A443</th>
      <th>TCGA-55-A4DG</th>
      <th>TCGA-67-4679</th>
      <th>TCGA-64-5781</th>
      <th>TCGA-93-A4JO</th>
      <th>TCGA-NJ-A4YP</th>
      <th>TCGA-69-7974</th>
      <th>TCGA-MP-A4T7</th>
      <th>TCGA-55-6642</th>
      <th>TCGA-49-AAR9</th>
      <th>TCGA-69-8253</th>
      <th>TCGA-05-4249</th>
      <th>TCGA-44-7669</th>
      <th>TCGA-71-6725</th>
      <th>TCGA-73-7499</th>
      <th>TCGA-MP-A4TH</th>
      <th>TCGA-55-8208</th>
      <th>TCGA-78-7156</th>
      <th>TCGA-75-5122</th>
      <th>TCGA-50-7109</th>
      <th>TCGA-NJ-A55R</th>
      <th>TCGA-53-A4EZ</th>
      <th>TCGA-NJ-A4YG</th>
      <th>TCGA-86-A456</th>
      <th>TCGA-38-4632</th>
      <th>TCGA-MP-A4TJ</th>
      <th>TCGA-97-8174</th>
      <th>TCGA-MP-A4SY</th>
      <th>TCGA-62-8397</th>
      <th>TCGA-L9-A8F4</th>
      <th>TCGA-75-5126</th>
      <th>TCGA-MP-A4TA</th>
      <th>TCGA-86-7711</th>
      <th>TCGA-50-5045</th>
      <th>TCGA-05-4417</th>
      <th>TCGA-44-7660</th>
      <th>TCGA-69-7979</th>
      <th>TCGA-55-A491</th>
      <th>TCGA-L9-A743</th>
      <th>TCGA-55-A494</th>
      <th>TCGA-44-7662</th>
      <th>TCGA-55-7910</th>
      <th>TCGA-69-7980</th>
      <th>TCGA-55-8097</th>
      <th>TCGA-73-4668</th>
      <th>TCGA-NJ-A55A</th>
      <th>TCGA-86-8672</th>
      <th>TCGA-86-8673</th>
      <th>TCGA-78-7153</th>
      <th>TCGA-97-A4M7</th>
      <th>TCGA-62-A46R</th>
      <th>TCGA-50-5055</th>
      <th>TCGA-38-4628</th>
      <th>TCGA-86-7713</th>
      <th>TCGA-86-8073</th>
      <th>TCGA-MN-A4N4</th>
      <th>TCGA-53-7626</th>
      <th>TCGA-44-A47G</th>
      <th>TCGA-55-6969</th>
    </tr>
    <tr>
      <th>GENES</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TSPAN6</th>
      <td>11.3668</td>
      <td>11.5434</td>
      <td>11.4110</td>
      <td>12.2149</td>
      <td>11.2882</td>
      <td>11.2084</td>
      <td>11.1717</td>
      <td>12.1281</td>
      <td>11.9908</td>
      <td>12.2601</td>
      <td>11.6963</td>
      <td>11.4364</td>
      <td>10.8184</td>
      <td>11.5513</td>
      <td>11.2016</td>
      <td>11.5201</td>
      <td>12.3420</td>
      <td>11.9378</td>
      <td>12.6268</td>
      <td>12.3495</td>
      <td>10.0858</td>
      <td>10.1934</td>
      <td>11.4793</td>
      <td>11.8151</td>
      <td>10.9083</td>
      <td>10.9789</td>
      <td>12.3310</td>
      <td>11.0959</td>
      <td>12.2844</td>
      <td>12.2692</td>
      <td>12.4793</td>
      <td>11.6572</td>
      <td>10.4046</td>
      <td>11.7654</td>
      <td>11.5185</td>
      <td>12.6804</td>
      <td>12.6905</td>
      <td>11.6912</td>
      <td>10.3112</td>
      <td>10.6976</td>
      <td>10.3748</td>
      <td>11.7572</td>
      <td>11.9412</td>
      <td>11.4387</td>
      <td>13.5286</td>
      <td>11.3330</td>
      <td>10.4583</td>
      <td>10.6897</td>
      <td>9.8078</td>
      <td>12.0396</td>
      <td>10.7139</td>
      <td>10.9416</td>
      <td>10.6148</td>
      <td>12.3594</td>
      <td>10.2641</td>
      <td>10.3341</td>
      <td>12.1122</td>
      <td>12.6116</td>
      <td>11.6780</td>
      <td>11.3810</td>
      <td>11.2908</td>
      <td>11.6346</td>
      <td>12.7436</td>
      <td>12.0022</td>
      <td>11.3310</td>
      <td>12.1321</td>
      <td>10.9049</td>
      <td>10.8718</td>
      <td>13.6990</td>
      <td>11.2008</td>
      <td>12.5260</td>
      <td>11.3536</td>
      <td>10.9310</td>
      <td>11.1425</td>
      <td>11.6935</td>
      <td>10.7492</td>
      <td>11.5179</td>
      <td>11.4193</td>
      <td>12.0642</td>
      <td>10.9989</td>
      <td>10.1955</td>
      <td>9.8547</td>
      <td>12.1975</td>
      <td>11.8144</td>
      <td>11.3360</td>
      <td>11.8734</td>
      <td>11.6592</td>
      <td>10.9656</td>
      <td>11.3940</td>
      <td>10.0536</td>
      <td>11.2797</td>
      <td>12.5194</td>
      <td>11.1115</td>
      <td>11.3718</td>
      <td>11.0992</td>
      <td>10.5568</td>
      <td>12.4242</td>
      <td>10.8483</td>
      <td>10.2531</td>
      <td>12.1970</td>
      <td>11.0435</td>
      <td>11.5506</td>
      <td>11.8431</td>
      <td>10.0167</td>
      <td>11.1656</td>
      <td>11.6305</td>
      <td>12.1896</td>
      <td>11.0415</td>
      <td>11.2189</td>
      <td>11.8492</td>
      <td>11.3662</td>
      <td>10.4561</td>
      <td>11.6218</td>
      <td>10.8172</td>
      <td>12.8664</td>
      <td>11.5225</td>
      <td>11.3115</td>
      <td>11.5578</td>
      <td>10.2480</td>
      <td>12.5978</td>
      <td>11.3813</td>
      <td>12.2305</td>
      <td>12.8613</td>
      <td>12.2530</td>
      <td>11.6121</td>
      <td>11.4228</td>
      <td>10.9524</td>
      <td>12.5578</td>
      <td>10.0787</td>
      <td>10.5769</td>
      <td>12.1344</td>
      <td>11.0673</td>
      <td>11.5503</td>
      <td>11.5436</td>
      <td>11.9898</td>
      <td>11.0150</td>
      <td>11.7263</td>
      <td>12.6511</td>
      <td>12.7900</td>
      <td>11.3529</td>
      <td>10.8869</td>
      <td>11.7057</td>
      <td>10.8965</td>
      <td>12.3545</td>
      <td>10.2583</td>
      <td>11.3722</td>
      <td>10.6833</td>
      <td>10.0881</td>
      <td>10.4599</td>
      <td>10.7081</td>
      <td>12.0397</td>
      <td>11.7018</td>
      <td>12.8565</td>
      <td>10.2880</td>
      <td>12.7978</td>
      <td>11.4706</td>
      <td>10.8476</td>
      <td>11.0805</td>
      <td>11.9734</td>
      <td>12.0851</td>
      <td>12.1795</td>
      <td>11.5371</td>
      <td>10.6095</td>
      <td>11.0963</td>
      <td>10.3040</td>
      <td>11.8762</td>
      <td>11.8054</td>
      <td>11.2086</td>
      <td>11.3926</td>
      <td>11.8264</td>
      <td>10.1947</td>
      <td>10.4312</td>
      <td>12.0766</td>
      <td>9.8166</td>
      <td>11.1579</td>
      <td>9.9593</td>
      <td>11.9509</td>
      <td>12.1032</td>
      <td>11.3955</td>
      <td>12.1417</td>
      <td>10.2608</td>
      <td>11.8510</td>
      <td>14.0084</td>
      <td>10.9162</td>
      <td>10.3611</td>
      <td>11.0810</td>
      <td>11.3337</td>
      <td>12.2993</td>
      <td>10.7740</td>
      <td>11.7357</td>
      <td>10.5070</td>
      <td>11.8349</td>
      <td>10.1911</td>
      <td>9.9479</td>
      <td>11.2712</td>
      <td>12.0021</td>
      <td>12.6501</td>
      <td>12.4788</td>
      <td>10.4014</td>
      <td>9.9802</td>
      <td>11.2009</td>
      <td>11.4114</td>
      <td>11.7631</td>
      <td>11.2826</td>
      <td>10.2483</td>
      <td>10.8454</td>
      <td>11.3710</td>
      <td>11.8123</td>
      <td>10.4946</td>
      <td>12.8853</td>
      <td>12.0419</td>
      <td>9.7825</td>
      <td>11.3508</td>
      <td>12.2113</td>
      <td>11.2109</td>
      <td>10.7897</td>
      <td>10.9245</td>
      <td>11.1760</td>
      <td>12.6706</td>
      <td>12.6263</td>
      <td>11.1184</td>
      <td>12.0847</td>
      <td>12.0260</td>
      <td>12.1872</td>
      <td>11.1890</td>
      <td>10.5380</td>
      <td>11.1885</td>
      <td>10.6572</td>
      <td>13.0727</td>
      <td>11.4913</td>
      <td>11.3143</td>
      <td>11.0925</td>
      <td>13.0532</td>
      <td>10.3230</td>
      <td>11.2059</td>
      <td>12.4663</td>
      <td>11.5834</td>
      <td>10.9066</td>
      <td>10.7345</td>
      <td>12.4693</td>
      <td>11.5575</td>
      <td>10.9213</td>
      <td>12.4820</td>
      <td>11.2840</td>
      <td>11.5141</td>
      <td>10.0187</td>
      <td>10.8694</td>
      <td>12.1195</td>
      <td>11.9295</td>
      <td>11.0260</td>
      <td>10.9569</td>
      <td>11.7140</td>
      <td>11.9341</td>
      <td>11.8186</td>
      <td>12.2848</td>
      <td>11.6558</td>
      <td>9.3353</td>
      <td>11.0606</td>
      <td>12.0642</td>
      <td>9.8124</td>
      <td>11.7632</td>
      <td>10.2884</td>
      <td>12.5910</td>
      <td>11.3659</td>
      <td>12.7780</td>
      <td>12.6628</td>
      <td>11.5601</td>
      <td>10.2000</td>
      <td>12.0653</td>
      <td>11.7465</td>
      <td>12.3923</td>
      <td>11.4238</td>
      <td>11.8239</td>
      <td>11.9585</td>
      <td>12.2011</td>
      <td>12.1427</td>
      <td>12.2740</td>
      <td>10.5354</td>
      <td>10.6766</td>
      <td>11.2521</td>
      <td>10.8593</td>
      <td>11.5535</td>
      <td>10.6908</td>
      <td>10.5088</td>
      <td>12.1103</td>
      <td>10.6678</td>
      <td>11.3580</td>
      <td>11.2907</td>
      <td>12.4034</td>
      <td>11.2444</td>
      <td>11.5573</td>
      <td>10.6814</td>
      <td>11.1324</td>
      <td>12.5396</td>
      <td>10.8427</td>
      <td>11.0895</td>
      <td>10.6759</td>
      <td>11.6387</td>
      <td>11.7932</td>
      <td>10.2316</td>
      <td>11.7782</td>
      <td>11.6473</td>
      <td>11.4396</td>
      <td>11.4026</td>
      <td>12.0780</td>
      <td>11.4128</td>
      <td>13.0523</td>
      <td>10.6577</td>
      <td>11.9695</td>
      <td>12.1888</td>
      <td>12.0151</td>
      <td>11.7835</td>
      <td>11.2857</td>
      <td>11.6833</td>
      <td>11.8953</td>
      <td>11.2430</td>
      <td>12.4815</td>
      <td>11.4569</td>
      <td>12.1892</td>
      <td>12.9238</td>
      <td>11.3341</td>
      <td>10.4122</td>
      <td>12.3289</td>
      <td>12.5716</td>
      <td>11.8607</td>
      <td>10.6942</td>
      <td>9.9505</td>
      <td>9.8565</td>
      <td>11.1532</td>
      <td>11.0083</td>
      <td>9.7749</td>
      <td>11.8172</td>
      <td>11.5265</td>
      <td>11.7539</td>
      <td>9.6730</td>
      <td>11.0506</td>
      <td>12.0793</td>
      <td>12.3549</td>
      <td>11.7789</td>
      <td>12.2414</td>
      <td>11.0330</td>
      <td>11.7827</td>
      <td>12.6700</td>
      <td>10.3898</td>
      <td>11.4081</td>
      <td>11.9690</td>
      <td>11.8487</td>
      <td>11.3940</td>
      <td>11.7816</td>
      <td>10.4786</td>
      <td>11.3588</td>
      <td>11.5056</td>
      <td>11.5659</td>
      <td>10.9077</td>
      <td>12.8481</td>
      <td>13.2597</td>
      <td>12.1043</td>
      <td>11.8132</td>
      <td>10.1705</td>
      <td>12.6113</td>
      <td>12.7393</td>
      <td>10.8212</td>
      <td>11.0022</td>
      <td>9.9679</td>
      <td>10.4334</td>
      <td>12.5928</td>
      <td>10.5347</td>
      <td>11.5644</td>
      <td>11.3865</td>
      <td>11.6430</td>
      <td>11.5043</td>
      <td>12.6001</td>
      <td>12.6972</td>
      <td>11.6720</td>
      <td>13.9840</td>
      <td>12.3083</td>
      <td>11.9275</td>
      <td>10.5632</td>
      <td>10.5139</td>
      <td>11.6059</td>
      <td>11.0129</td>
      <td>10.9546</td>
      <td>11.0942</td>
      <td>11.9468</td>
      <td>11.2219</td>
      <td>11.4285</td>
      <td>11.4685</td>
      <td>11.9371</td>
      <td>10.7517</td>
      <td>11.0095</td>
      <td>9.9635</td>
      <td>12.0445</td>
      <td>11.4242</td>
      <td>10.2734</td>
      <td>10.5699</td>
      <td>12.1478</td>
      <td>12.6972</td>
      <td>11.1324</td>
      <td>9.7751</td>
      <td>10.5446</td>
      <td>9.7483</td>
      <td>12.8170</td>
      <td>11.8853</td>
      <td>12.4547</td>
      <td>10.2181</td>
      <td>11.4485</td>
      <td>11.1449</td>
      <td>10.6456</td>
      <td>11.8871</td>
      <td>10.8452</td>
      <td>10.8434</td>
      <td>11.1721</td>
      <td>11.5949</td>
      <td>12.3783</td>
      <td>10.1246</td>
      <td>11.0102</td>
      <td>10.7886</td>
      <td>12.4142</td>
      <td>13.2311</td>
      <td>11.3050</td>
      <td>11.1573</td>
      <td>10.8217</td>
      <td>11.2405</td>
      <td>12.1907</td>
      <td>11.6480</td>
      <td>10.7273</td>
      <td>10.8609</td>
      <td>12.3249</td>
      <td>11.5895</td>
      <td>11.3989</td>
      <td>12.5339</td>
      <td>10.8605</td>
      <td>12.1548</td>
      <td>11.3018</td>
      <td>11.1675</td>
      <td>11.8632</td>
      <td>11.6934</td>
      <td>11.9824</td>
      <td>11.7301</td>
      <td>11.1696</td>
      <td>9.6553</td>
      <td>10.9355</td>
      <td>11.4443</td>
      <td>11.6764</td>
      <td>10.8236</td>
      <td>10.9707</td>
      <td>10.3842</td>
      <td>11.2515</td>
      <td>11.6288</td>
      <td>10.6570</td>
      <td>11.5372</td>
      <td>11.0214</td>
      <td>11.6107</td>
      <td>12.2799</td>
      <td>9.9885</td>
      <td>10.8204</td>
      <td>11.5185</td>
      <td>11.2179</td>
      <td>11.4793</td>
      <td>10.5852</td>
      <td>11.8688</td>
      <td>10.9679</td>
      <td>11.1557</td>
      <td>12.5560</td>
      <td>11.0278</td>
      <td>11.2249</td>
      <td>11.7138</td>
      <td>12.0610</td>
      <td>11.0386</td>
      <td>11.7022</td>
      <td>10.7661</td>
      <td>11.5559</td>
      <td>12.3662</td>
      <td>11.6695</td>
      <td>12.3629</td>
      <td>10.0493</td>
      <td>12.6781</td>
      <td>11.1947</td>
      <td>10.2288</td>
      <td>11.1006</td>
      <td>10.7090</td>
      <td>11.5433</td>
      <td>10.6578</td>
      <td>12.2400</td>
      <td>12.2886</td>
      <td>11.0114</td>
      <td>11.1331</td>
      <td>12.7791</td>
      <td>11.4336</td>
      <td>11.4533</td>
      <td>11.8079</td>
      <td>11.3954</td>
      <td>12.2414</td>
      <td>10.7676</td>
      <td>11.6560</td>
      <td>10.8912</td>
      <td>11.3200</td>
      <td>10.5764</td>
    </tr>
    <tr>
      <th>DPM1</th>
      <td>10.3673</td>
      <td>10.5282</td>
      <td>11.2018</td>
      <td>10.3249</td>
      <td>10.2095</td>
      <td>11.6034</td>
      <td>10.5684</td>
      <td>10.5895</td>
      <td>10.8699</td>
      <td>10.8979</td>
      <td>10.2597</td>
      <td>10.2811</td>
      <td>10.5428</td>
      <td>11.4632</td>
      <td>10.4191</td>
      <td>11.1089</td>
      <td>11.7516</td>
      <td>11.0717</td>
      <td>11.3598</td>
      <td>10.5437</td>
      <td>10.1693</td>
      <td>10.4140</td>
      <td>10.5354</td>
      <td>10.7697</td>
      <td>11.1321</td>
      <td>10.9468</td>
      <td>11.0926</td>
      <td>10.7382</td>
      <td>10.8152</td>
      <td>10.3957</td>
      <td>10.4709</td>
      <td>10.1559</td>
      <td>9.9805</td>
      <td>11.4481</td>
      <td>10.4410</td>
      <td>12.3449</td>
      <td>12.0215</td>
      <td>9.8339</td>
      <td>9.8155</td>
      <td>11.1057</td>
      <td>10.6229</td>
      <td>10.3072</td>
      <td>10.9156</td>
      <td>10.6567</td>
      <td>11.9269</td>
      <td>11.2991</td>
      <td>10.1423</td>
      <td>10.3601</td>
      <td>10.1592</td>
      <td>10.7380</td>
      <td>10.4286</td>
      <td>10.4356</td>
      <td>10.3590</td>
      <td>12.4895</td>
      <td>10.1547</td>
      <td>10.5626</td>
      <td>10.0477</td>
      <td>10.5382</td>
      <td>9.9913</td>
      <td>10.2894</td>
      <td>10.8054</td>
      <td>10.1605</td>
      <td>10.0190</td>
      <td>11.5081</td>
      <td>10.0984</td>
      <td>11.3601</td>
      <td>10.6430</td>
      <td>10.6521</td>
      <td>11.1387</td>
      <td>11.3382</td>
      <td>10.2255</td>
      <td>10.0836</td>
      <td>10.4917</td>
      <td>10.0090</td>
      <td>11.9545</td>
      <td>10.0906</td>
      <td>11.3592</td>
      <td>9.9883</td>
      <td>10.3982</td>
      <td>10.5526</td>
      <td>10.2111</td>
      <td>10.2224</td>
      <td>10.3080</td>
      <td>10.4408</td>
      <td>10.1729</td>
      <td>10.0785</td>
      <td>10.3417</td>
      <td>11.0045</td>
      <td>9.9599</td>
      <td>10.3394</td>
      <td>10.2760</td>
      <td>11.3405</td>
      <td>10.1568</td>
      <td>10.4120</td>
      <td>10.2278</td>
      <td>10.8406</td>
      <td>10.5518</td>
      <td>10.6743</td>
      <td>10.1342</td>
      <td>10.6351</td>
      <td>10.0925</td>
      <td>11.4544</td>
      <td>10.6302</td>
      <td>10.0922</td>
      <td>10.3143</td>
      <td>10.0360</td>
      <td>10.5034</td>
      <td>10.0045</td>
      <td>10.0630</td>
      <td>9.8141</td>
      <td>10.3974</td>
      <td>10.2130</td>
      <td>10.9346</td>
      <td>10.9549</td>
      <td>10.2702</td>
      <td>10.4995</td>
      <td>10.5450</td>
      <td>11.4992</td>
      <td>10.0573</td>
      <td>9.6467</td>
      <td>10.1493</td>
      <td>10.0933</td>
      <td>11.0881</td>
      <td>12.0558</td>
      <td>11.0665</td>
      <td>10.3363</td>
      <td>10.5444</td>
      <td>10.3785</td>
      <td>10.1670</td>
      <td>10.3885</td>
      <td>10.8217</td>
      <td>10.4592</td>
      <td>11.4573</td>
      <td>10.3285</td>
      <td>10.6120</td>
      <td>11.0075</td>
      <td>10.4944</td>
      <td>11.1837</td>
      <td>11.7792</td>
      <td>10.1174</td>
      <td>10.3780</td>
      <td>9.6809</td>
      <td>10.1563</td>
      <td>11.0345</td>
      <td>9.9656</td>
      <td>9.6733</td>
      <td>10.8477</td>
      <td>9.6414</td>
      <td>10.4871</td>
      <td>10.1464</td>
      <td>10.5615</td>
      <td>10.7224</td>
      <td>10.3989</td>
      <td>10.2802</td>
      <td>10.9204</td>
      <td>10.2679</td>
      <td>10.4497</td>
      <td>10.7129</td>
      <td>11.1628</td>
      <td>10.4072</td>
      <td>11.0103</td>
      <td>10.5530</td>
      <td>10.7263</td>
      <td>10.4121</td>
      <td>10.6011</td>
      <td>10.4475</td>
      <td>10.4723</td>
      <td>11.0430</td>
      <td>10.3518</td>
      <td>10.2918</td>
      <td>11.4870</td>
      <td>10.6665</td>
      <td>10.6233</td>
      <td>10.2224</td>
      <td>9.8892</td>
      <td>9.8752</td>
      <td>10.2606</td>
      <td>10.4278</td>
      <td>10.1204</td>
      <td>10.5046</td>
      <td>10.5811</td>
      <td>9.9467</td>
      <td>11.3648</td>
      <td>10.6513</td>
      <td>10.7957</td>
      <td>11.3752</td>
      <td>10.8785</td>
      <td>10.6078</td>
      <td>12.4100</td>
      <td>10.6967</td>
      <td>10.1885</td>
      <td>11.0354</td>
      <td>10.5423</td>
      <td>10.0410</td>
      <td>9.7252</td>
      <td>10.0059</td>
      <td>11.3611</td>
      <td>10.4094</td>
      <td>10.7109</td>
      <td>10.2990</td>
      <td>9.6637</td>
      <td>10.2146</td>
      <td>10.3319</td>
      <td>10.9650</td>
      <td>11.0105</td>
      <td>10.4496</td>
      <td>9.5375</td>
      <td>11.0195</td>
      <td>10.4263</td>
      <td>10.0014</td>
      <td>11.7075</td>
      <td>9.7232</td>
      <td>10.4508</td>
      <td>10.6472</td>
      <td>10.4813</td>
      <td>10.2382</td>
      <td>9.8675</td>
      <td>9.7808</td>
      <td>10.7801</td>
      <td>10.9638</td>
      <td>10.7165</td>
      <td>10.8844</td>
      <td>9.6931</td>
      <td>10.1148</td>
      <td>10.5937</td>
      <td>10.0443</td>
      <td>10.1051</td>
      <td>9.8038</td>
      <td>10.9006</td>
      <td>10.7497</td>
      <td>11.1005</td>
      <td>9.6334</td>
      <td>10.6470</td>
      <td>9.6086</td>
      <td>10.4662</td>
      <td>9.7965</td>
      <td>9.6259</td>
      <td>10.6728</td>
      <td>10.4062</td>
      <td>10.4734</td>
      <td>10.2548</td>
      <td>10.3992</td>
      <td>10.7673</td>
      <td>10.5584</td>
      <td>10.6872</td>
      <td>10.1128</td>
      <td>10.5001</td>
      <td>10.7337</td>
      <td>10.6823</td>
      <td>10.3774</td>
      <td>10.5507</td>
      <td>9.5723</td>
      <td>11.0563</td>
      <td>11.3820</td>
      <td>10.7984</td>
      <td>10.2953</td>
      <td>10.4317</td>
      <td>10.9132</td>
      <td>10.7706</td>
      <td>10.3170</td>
      <td>9.8159</td>
      <td>10.7112</td>
      <td>10.5911</td>
      <td>10.5216</td>
      <td>11.0934</td>
      <td>10.1872</td>
      <td>11.4650</td>
      <td>10.0845</td>
      <td>10.6251</td>
      <td>10.2238</td>
      <td>11.8974</td>
      <td>10.0741</td>
      <td>10.2667</td>
      <td>11.4990</td>
      <td>10.2143</td>
      <td>10.7719</td>
      <td>10.4364</td>
      <td>9.9946</td>
      <td>10.6327</td>
      <td>9.9117</td>
      <td>10.7585</td>
      <td>10.6781</td>
      <td>10.8452</td>
      <td>10.2105</td>
      <td>10.5266</td>
      <td>10.7068</td>
      <td>9.5639</td>
      <td>10.3362</td>
      <td>10.1308</td>
      <td>10.2051</td>
      <td>10.3487</td>
      <td>10.4209</td>
      <td>10.3560</td>
      <td>9.9935</td>
      <td>10.3846</td>
      <td>10.2926</td>
      <td>10.5870</td>
      <td>10.2013</td>
      <td>10.1682</td>
      <td>10.0883</td>
      <td>11.1945</td>
      <td>10.6828</td>
      <td>10.6559</td>
      <td>10.3926</td>
      <td>10.7314</td>
      <td>11.3593</td>
      <td>12.3765</td>
      <td>10.0253</td>
      <td>9.8573</td>
      <td>10.7042</td>
      <td>9.9889</td>
      <td>10.8183</td>
      <td>10.5255</td>
      <td>10.8122</td>
      <td>9.9752</td>
      <td>10.8340</td>
      <td>10.7147</td>
      <td>10.3240</td>
      <td>11.6552</td>
      <td>11.4148</td>
      <td>11.1563</td>
      <td>11.1943</td>
      <td>10.2782</td>
      <td>10.4931</td>
      <td>10.3662</td>
      <td>10.2788</td>
      <td>10.6498</td>
      <td>10.3249</td>
      <td>10.2040</td>
      <td>10.5631</td>
      <td>10.0752</td>
      <td>11.5878</td>
      <td>10.1247</td>
      <td>9.9811</td>
      <td>10.3253</td>
      <td>9.9141</td>
      <td>10.6591</td>
      <td>10.3958</td>
      <td>10.5550</td>
      <td>11.0409</td>
      <td>10.5295</td>
      <td>10.5735</td>
      <td>11.0035</td>
      <td>10.3892</td>
      <td>9.4086</td>
      <td>10.6769</td>
      <td>10.6982</td>
      <td>10.5302</td>
      <td>10.5096</td>
      <td>10.2051</td>
      <td>10.4566</td>
      <td>9.7456</td>
      <td>10.7550</td>
      <td>10.3593</td>
      <td>10.7888</td>
      <td>11.0977</td>
      <td>10.4838</td>
      <td>10.1326</td>
      <td>10.8935</td>
      <td>10.1556</td>
      <td>10.2567</td>
      <td>10.6765</td>
      <td>11.0303</td>
      <td>10.0184</td>
      <td>11.2173</td>
      <td>11.0190</td>
      <td>10.6367</td>
      <td>10.4657</td>
      <td>10.7996</td>
      <td>10.3412</td>
      <td>10.5155</td>
      <td>10.9056</td>
      <td>10.4717</td>
      <td>11.0922</td>
      <td>10.7262</td>
      <td>10.4186</td>
      <td>10.4778</td>
      <td>10.8818</td>
      <td>10.6244</td>
      <td>9.9601</td>
      <td>10.3842</td>
      <td>10.8874</td>
      <td>9.8919</td>
      <td>10.2086</td>
      <td>10.3251</td>
      <td>10.6865</td>
      <td>10.7666</td>
      <td>10.0151</td>
      <td>10.1534</td>
      <td>9.8252</td>
      <td>10.3318</td>
      <td>10.4129</td>
      <td>10.1555</td>
      <td>10.6197</td>
      <td>10.1391</td>
      <td>10.2610</td>
      <td>10.6608</td>
      <td>10.4759</td>
      <td>10.8768</td>
      <td>9.4212</td>
      <td>10.1342</td>
      <td>9.6859</td>
      <td>10.7873</td>
      <td>9.9960</td>
      <td>10.3806</td>
      <td>10.5536</td>
      <td>9.9261</td>
      <td>11.0626</td>
      <td>10.3189</td>
      <td>10.3556</td>
      <td>10.8261</td>
      <td>10.7788</td>
      <td>10.4143</td>
      <td>10.6831</td>
      <td>9.6615</td>
      <td>9.8619</td>
      <td>9.6148</td>
      <td>10.3166</td>
      <td>12.1833</td>
      <td>10.8128</td>
      <td>10.2940</td>
      <td>10.3546</td>
      <td>10.1513</td>
      <td>9.9935</td>
      <td>10.6634</td>
      <td>10.6151</td>
      <td>10.3034</td>
      <td>11.0388</td>
      <td>9.6084</td>
      <td>10.1049</td>
      <td>10.3442</td>
      <td>10.0398</td>
      <td>10.2584</td>
      <td>10.6060</td>
      <td>9.9462</td>
      <td>10.6935</td>
      <td>10.1466</td>
      <td>10.9851</td>
      <td>9.7722</td>
      <td>10.2135</td>
      <td>10.4614</td>
      <td>10.0556</td>
      <td>10.9664</td>
      <td>10.8430</td>
      <td>10.4458</td>
      <td>10.4976</td>
      <td>10.7279</td>
      <td>10.0624</td>
      <td>11.0496</td>
      <td>11.2922</td>
      <td>10.4160</td>
      <td>10.8245</td>
      <td>10.8518</td>
      <td>11.4070</td>
      <td>9.4562</td>
      <td>10.7687</td>
      <td>10.2546</td>
      <td>10.4619</td>
      <td>11.0633</td>
      <td>10.1659</td>
      <td>10.0678</td>
      <td>10.2079</td>
      <td>10.5422</td>
      <td>11.4943</td>
      <td>10.3799</td>
      <td>9.8810</td>
      <td>10.8335</td>
      <td>10.4836</td>
      <td>10.4381</td>
      <td>11.1644</td>
      <td>10.8843</td>
      <td>10.8769</td>
      <td>10.9079</td>
      <td>9.8726</td>
      <td>10.8641</td>
      <td>10.8005</td>
      <td>10.4343</td>
      <td>10.3455</td>
      <td>9.4051</td>
      <td>10.9179</td>
      <td>11.6558</td>
      <td>10.2703</td>
      <td>9.5834</td>
      <td>11.0609</td>
      <td>10.2996</td>
      <td>10.9338</td>
      <td>10.2698</td>
      <td>10.3567</td>
      <td>9.8932</td>
      <td>10.7229</td>
      <td>10.7633</td>
      <td>11.0195</td>
      <td>10.5073</td>
      <td>10.5503</td>
      <td>11.0739</td>
      <td>10.1742</td>
      <td>9.9137</td>
      <td>10.9022</td>
    </tr>
    <tr>
      <th>SCYL3</th>
      <td>9.7884</td>
      <td>9.7292</td>
      <td>9.4449</td>
      <td>9.2340</td>
      <td>9.8186</td>
      <td>9.0884</td>
      <td>10.2428</td>
      <td>10.1989</td>
      <td>9.8516</td>
      <td>9.7973</td>
      <td>10.4597</td>
      <td>9.5387</td>
      <td>9.1616</td>
      <td>9.6713</td>
      <td>9.1914</td>
      <td>9.1989</td>
      <td>9.0392</td>
      <td>9.7859</td>
      <td>9.5704</td>
      <td>9.3099</td>
      <td>9.9071</td>
      <td>10.2033</td>
      <td>9.4620</td>
      <td>8.8882</td>
      <td>8.9993</td>
      <td>9.2914</td>
      <td>10.1648</td>
      <td>9.6722</td>
      <td>9.8902</td>
      <td>9.5831</td>
      <td>9.6185</td>
      <td>9.3662</td>
      <td>9.4164</td>
      <td>9.3445</td>
      <td>9.0884</td>
      <td>9.9466</td>
      <td>10.5563</td>
      <td>9.5650</td>
      <td>9.5591</td>
      <td>9.8518</td>
      <td>9.2797</td>
      <td>9.9954</td>
      <td>10.1827</td>
      <td>9.6889</td>
      <td>9.2378</td>
      <td>10.1650</td>
      <td>9.2111</td>
      <td>8.3509</td>
      <td>9.3441</td>
      <td>9.2187</td>
      <td>9.2483</td>
      <td>9.7711</td>
      <td>9.4156</td>
      <td>10.4581</td>
      <td>8.9691</td>
      <td>9.2670</td>
      <td>9.5723</td>
      <td>10.6370</td>
      <td>10.3945</td>
      <td>10.0023</td>
      <td>9.4692</td>
      <td>9.3656</td>
      <td>10.1750</td>
      <td>10.6553</td>
      <td>9.5655</td>
      <td>9.6904</td>
      <td>9.1352</td>
      <td>10.5748</td>
      <td>9.0598</td>
      <td>9.3388</td>
      <td>9.0138</td>
      <td>10.1941</td>
      <td>9.7808</td>
      <td>9.2933</td>
      <td>9.5845</td>
      <td>10.2226</td>
      <td>9.7462</td>
      <td>9.5927</td>
      <td>9.3558</td>
      <td>9.2934</td>
      <td>9.5384</td>
      <td>9.4034</td>
      <td>9.1338</td>
      <td>9.0750</td>
      <td>9.5706</td>
      <td>8.9542</td>
      <td>9.3475</td>
      <td>9.1997</td>
      <td>9.3012</td>
      <td>10.0962</td>
      <td>10.6254</td>
      <td>9.6891</td>
      <td>9.6099</td>
      <td>9.7300</td>
      <td>9.3831</td>
      <td>8.8079</td>
      <td>9.7910</td>
      <td>8.8135</td>
      <td>9.0254</td>
      <td>9.3585</td>
      <td>8.9728</td>
      <td>9.6625</td>
      <td>9.4022</td>
      <td>9.1939</td>
      <td>8.8231</td>
      <td>10.0313</td>
      <td>9.0316</td>
      <td>8.7873</td>
      <td>9.5787</td>
      <td>9.4269</td>
      <td>9.5178</td>
      <td>10.0869</td>
      <td>9.9300</td>
      <td>9.7401</td>
      <td>9.8480</td>
      <td>9.3712</td>
      <td>9.7986</td>
      <td>9.4122</td>
      <td>8.5703</td>
      <td>9.3572</td>
      <td>9.4105</td>
      <td>9.8800</td>
      <td>9.4892</td>
      <td>9.5534</td>
      <td>9.9758</td>
      <td>9.7279</td>
      <td>9.8356</td>
      <td>9.5767</td>
      <td>9.4541</td>
      <td>10.2115</td>
      <td>9.6805</td>
      <td>8.8872</td>
      <td>9.8853</td>
      <td>9.4723</td>
      <td>9.6099</td>
      <td>9.4472</td>
      <td>8.9678</td>
      <td>9.5603</td>
      <td>10.3938</td>
      <td>10.0234</td>
      <td>9.7362</td>
      <td>9.9193</td>
      <td>9.1959</td>
      <td>8.6483</td>
      <td>9.2934</td>
      <td>9.9753</td>
      <td>8.8689</td>
      <td>10.2857</td>
      <td>9.1127</td>
      <td>10.0076</td>
      <td>10.2159</td>
      <td>8.6584</td>
      <td>9.8026</td>
      <td>9.4232</td>
      <td>10.0368</td>
      <td>9.4994</td>
      <td>9.1809</td>
      <td>9.6941</td>
      <td>9.4753</td>
      <td>9.7173</td>
      <td>9.6417</td>
      <td>9.9378</td>
      <td>9.5271</td>
      <td>9.2557</td>
      <td>10.0794</td>
      <td>9.6618</td>
      <td>9.4519</td>
      <td>9.9135</td>
      <td>9.8384</td>
      <td>9.5287</td>
      <td>9.9231</td>
      <td>9.5156</td>
      <td>9.7516</td>
      <td>9.2277</td>
      <td>11.8243</td>
      <td>9.4455</td>
      <td>9.2924</td>
      <td>9.3730</td>
      <td>9.2214</td>
      <td>9.6726</td>
      <td>9.1222</td>
      <td>9.8190</td>
      <td>9.1053</td>
      <td>9.3210</td>
      <td>7.9588</td>
      <td>9.3426</td>
      <td>9.7862</td>
      <td>9.6415</td>
      <td>8.9893</td>
      <td>9.3399</td>
      <td>9.3363</td>
      <td>10.2430</td>
      <td>8.8740</td>
      <td>9.4316</td>
      <td>9.7870</td>
      <td>9.2739</td>
      <td>9.8320</td>
      <td>9.0703</td>
      <td>10.4094</td>
      <td>9.2132</td>
      <td>8.9828</td>
      <td>9.2478</td>
      <td>9.0566</td>
      <td>9.0567</td>
      <td>9.1049</td>
      <td>10.0076</td>
      <td>9.5664</td>
      <td>9.2488</td>
      <td>10.0838</td>
      <td>9.7055</td>
      <td>8.8724</td>
      <td>9.1715</td>
      <td>9.8818</td>
      <td>9.5381</td>
      <td>9.6877</td>
      <td>9.9796</td>
      <td>9.7347</td>
      <td>9.7612</td>
      <td>9.4238</td>
      <td>9.0414</td>
      <td>9.6469</td>
      <td>10.0605</td>
      <td>9.5776</td>
      <td>9.2431</td>
      <td>9.6940</td>
      <td>9.5104</td>
      <td>8.7772</td>
      <td>9.6834</td>
      <td>9.7049</td>
      <td>9.5464</td>
      <td>10.1800</td>
      <td>10.1731</td>
      <td>8.9434</td>
      <td>10.1129</td>
      <td>9.5120</td>
      <td>9.9568</td>
      <td>9.3915</td>
      <td>9.6556</td>
      <td>9.6057</td>
      <td>9.2214</td>
      <td>9.3705</td>
      <td>9.4333</td>
      <td>9.4012</td>
      <td>9.7564</td>
      <td>9.8985</td>
      <td>9.3117</td>
      <td>9.2219</td>
      <td>9.1313</td>
      <td>9.1250</td>
      <td>9.3155</td>
      <td>8.5723</td>
      <td>8.9149</td>
      <td>8.8896</td>
      <td>10.1626</td>
      <td>9.3895</td>
      <td>10.0364</td>
      <td>8.5380</td>
      <td>9.5676</td>
      <td>10.0258</td>
      <td>9.3249</td>
      <td>9.4584</td>
      <td>9.4167</td>
      <td>9.1765</td>
      <td>9.3333</td>
      <td>9.9249</td>
      <td>10.2258</td>
      <td>9.3517</td>
      <td>9.3738</td>
      <td>9.4879</td>
      <td>9.8991</td>
      <td>9.2620</td>
      <td>10.0403</td>
      <td>9.3082</td>
      <td>8.6391</td>
      <td>9.4582</td>
      <td>9.2066</td>
      <td>9.6627</td>
      <td>8.9497</td>
      <td>8.4621</td>
      <td>8.9667</td>
      <td>10.2945</td>
      <td>9.5630</td>
      <td>10.3852</td>
      <td>9.7173</td>
      <td>9.4638</td>
      <td>8.7810</td>
      <td>9.3086</td>
      <td>9.1673</td>
      <td>9.4087</td>
      <td>9.7618</td>
      <td>8.9834</td>
      <td>9.8248</td>
      <td>9.1231</td>
      <td>9.4784</td>
      <td>8.9424</td>
      <td>10.0797</td>
      <td>9.7576</td>
      <td>10.4031</td>
      <td>9.3747</td>
      <td>9.6217</td>
      <td>10.1896</td>
      <td>9.4505</td>
      <td>9.9546</td>
      <td>9.1939</td>
      <td>9.7137</td>
      <td>9.3683</td>
      <td>9.1750</td>
      <td>9.1421</td>
      <td>9.4496</td>
      <td>9.7904</td>
      <td>9.9654</td>
      <td>9.4372</td>
      <td>9.9617</td>
      <td>9.2584</td>
      <td>9.9010</td>
      <td>9.5597</td>
      <td>9.9597</td>
      <td>9.9692</td>
      <td>9.3522</td>
      <td>9.7765</td>
      <td>8.7170</td>
      <td>9.6048</td>
      <td>9.5941</td>
      <td>9.7829</td>
      <td>9.4945</td>
      <td>9.8494</td>
      <td>8.8990</td>
      <td>9.6106</td>
      <td>10.0654</td>
      <td>9.4878</td>
      <td>9.3299</td>
      <td>8.8287</td>
      <td>9.3280</td>
      <td>9.8321</td>
      <td>9.3744</td>
      <td>9.2514</td>
      <td>9.0631</td>
      <td>9.2725</td>
      <td>9.5093</td>
      <td>9.1426</td>
      <td>9.4783</td>
      <td>9.1251</td>
      <td>9.4141</td>
      <td>8.7055</td>
      <td>10.5948</td>
      <td>9.4177</td>
      <td>9.2547</td>
      <td>9.1221</td>
      <td>9.8962</td>
      <td>9.6861</td>
      <td>9.6418</td>
      <td>9.2168</td>
      <td>9.5201</td>
      <td>10.1573</td>
      <td>11.0186</td>
      <td>9.9912</td>
      <td>8.6901</td>
      <td>9.4823</td>
      <td>9.8922</td>
      <td>9.7491</td>
      <td>9.9393</td>
      <td>8.9300</td>
      <td>9.7732</td>
      <td>9.4625</td>
      <td>10.4722</td>
      <td>9.2756</td>
      <td>8.5539</td>
      <td>9.4335</td>
      <td>9.9991</td>
      <td>9.6167</td>
      <td>9.9887</td>
      <td>9.3647</td>
      <td>9.5085</td>
      <td>10.1092</td>
      <td>9.5667</td>
      <td>9.4444</td>
      <td>9.7623</td>
      <td>10.0350</td>
      <td>8.7668</td>
      <td>9.2513</td>
      <td>8.9995</td>
      <td>9.6443</td>
      <td>9.7327</td>
      <td>9.2836</td>
      <td>9.1662</td>
      <td>9.4191</td>
      <td>9.7447</td>
      <td>9.1672</td>
      <td>9.4019</td>
      <td>9.4430</td>
      <td>9.4113</td>
      <td>9.4753</td>
      <td>9.4045</td>
      <td>9.4526</td>
      <td>9.5222</td>
      <td>10.1365</td>
      <td>9.6688</td>
      <td>9.3138</td>
      <td>9.0650</td>
      <td>9.9093</td>
      <td>10.1098</td>
      <td>9.0354</td>
      <td>10.1722</td>
      <td>9.8626</td>
      <td>9.6334</td>
      <td>9.4093</td>
      <td>10.5626</td>
      <td>9.3962</td>
      <td>9.6598</td>
      <td>8.8236</td>
      <td>8.8226</td>
      <td>9.9742</td>
      <td>9.4260</td>
      <td>9.4048</td>
      <td>9.1882</td>
      <td>9.2809</td>
      <td>9.3073</td>
      <td>10.7647</td>
      <td>9.6210</td>
      <td>9.8062</td>
      <td>10.4229</td>
      <td>10.1405</td>
      <td>9.7423</td>
      <td>9.3376</td>
      <td>9.6765</td>
      <td>9.5753</td>
      <td>9.3374</td>
      <td>9.5080</td>
      <td>9.3468</td>
      <td>9.6630</td>
      <td>9.9180</td>
      <td>9.6452</td>
      <td>9.6021</td>
      <td>9.1445</td>
      <td>10.7054</td>
      <td>10.3428</td>
      <td>9.5334</td>
      <td>8.8020</td>
      <td>9.4802</td>
      <td>9.6960</td>
      <td>10.3752</td>
      <td>10.3503</td>
      <td>9.6493</td>
      <td>9.6399</td>
      <td>9.8303</td>
      <td>9.2408</td>
      <td>9.2355</td>
      <td>9.4554</td>
      <td>9.8303</td>
      <td>9.4898</td>
      <td>10.1210</td>
      <td>9.4890</td>
      <td>9.5164</td>
      <td>9.9131</td>
      <td>10.0144</td>
      <td>9.3105</td>
      <td>10.5826</td>
      <td>8.8982</td>
      <td>8.9016</td>
      <td>9.7922</td>
      <td>9.1497</td>
      <td>9.8255</td>
      <td>9.0385</td>
      <td>9.5056</td>
      <td>9.3626</td>
      <td>10.0143</td>
      <td>9.2308</td>
      <td>9.8938</td>
      <td>9.1274</td>
      <td>8.7230</td>
      <td>9.3022</td>
      <td>9.4158</td>
      <td>9.0778</td>
      <td>9.3721</td>
      <td>9.6511</td>
      <td>9.2463</td>
      <td>9.7447</td>
      <td>9.0294</td>
      <td>9.7439</td>
      <td>9.6689</td>
      <td>9.4864</td>
      <td>9.4727</td>
      <td>9.5110</td>
      <td>8.8101</td>
      <td>9.7125</td>
      <td>8.7629</td>
      <td>8.2262</td>
      <td>9.4804</td>
      <td>9.2713</td>
      <td>9.7087</td>
      <td>9.3311</td>
      <td>9.7850</td>
      <td>10.4121</td>
      <td>9.0277</td>
      <td>9.5578</td>
      <td>9.6307</td>
      <td>9.3312</td>
      <td>9.3425</td>
    </tr>
    <tr>
      <th>FIRRM</th>
      <td>8.2552</td>
      <td>7.9951</td>
      <td>8.3546</td>
      <td>7.7537</td>
      <td>7.9844</td>
      <td>8.7984</td>
      <td>8.8721</td>
      <td>8.3550</td>
      <td>8.1877</td>
      <td>9.2347</td>
      <td>9.8346</td>
      <td>7.8180</td>
      <td>9.0867</td>
      <td>7.4249</td>
      <td>7.2293</td>
      <td>9.1192</td>
      <td>10.0768</td>
      <td>9.4085</td>
      <td>10.0984</td>
      <td>7.4506</td>
      <td>9.3028</td>
      <td>8.9049</td>
      <td>8.0116</td>
      <td>8.5089</td>
      <td>7.1778</td>
      <td>7.2466</td>
      <td>9.0061</td>
      <td>8.9549</td>
      <td>9.0305</td>
      <td>8.8959</td>
      <td>8.5437</td>
      <td>7.0665</td>
      <td>7.0667</td>
      <td>9.0817</td>
      <td>8.4102</td>
      <td>9.6505</td>
      <td>9.6165</td>
      <td>8.0169</td>
      <td>7.4297</td>
      <td>9.2275</td>
      <td>8.1630</td>
      <td>8.6609</td>
      <td>8.6540</td>
      <td>8.5377</td>
      <td>10.2647</td>
      <td>9.1622</td>
      <td>6.8973</td>
      <td>7.7967</td>
      <td>7.6247</td>
      <td>9.1262</td>
      <td>6.8227</td>
      <td>9.6407</td>
      <td>7.7675</td>
      <td>8.8511</td>
      <td>7.9248</td>
      <td>7.1463</td>
      <td>8.5977</td>
      <td>8.7141</td>
      <td>8.4354</td>
      <td>9.3176</td>
      <td>9.1287</td>
      <td>7.7488</td>
      <td>7.4630</td>
      <td>9.1531</td>
      <td>9.0223</td>
      <td>8.8943</td>
      <td>8.0016</td>
      <td>8.9260</td>
      <td>9.3683</td>
      <td>7.3502</td>
      <td>7.9927</td>
      <td>7.5116</td>
      <td>9.1125</td>
      <td>8.6168</td>
      <td>10.1938</td>
      <td>8.4295</td>
      <td>8.3625</td>
      <td>8.2439</td>
      <td>8.6173</td>
      <td>8.4754</td>
      <td>6.9050</td>
      <td>7.3625</td>
      <td>7.4183</td>
      <td>8.6270</td>
      <td>8.2785</td>
      <td>8.6444</td>
      <td>8.0100</td>
      <td>8.3573</td>
      <td>7.2562</td>
      <td>8.2185</td>
      <td>8.4154</td>
      <td>9.1849</td>
      <td>7.8837</td>
      <td>8.2931</td>
      <td>8.8700</td>
      <td>8.8411</td>
      <td>8.7850</td>
      <td>7.2378</td>
      <td>8.3485</td>
      <td>7.1572</td>
      <td>6.9420</td>
      <td>9.2182</td>
      <td>9.6594</td>
      <td>7.7147</td>
      <td>7.1512</td>
      <td>7.6799</td>
      <td>8.5778</td>
      <td>7.9356</td>
      <td>7.2182</td>
      <td>7.3954</td>
      <td>8.9182</td>
      <td>8.2565</td>
      <td>8.4605</td>
      <td>9.2185</td>
      <td>8.1700</td>
      <td>8.8033</td>
      <td>8.3172</td>
      <td>9.7413</td>
      <td>6.4640</td>
      <td>8.4542</td>
      <td>8.4359</td>
      <td>8.2728</td>
      <td>9.2869</td>
      <td>9.2661</td>
      <td>8.2354</td>
      <td>8.4339</td>
      <td>8.5297</td>
      <td>8.7293</td>
      <td>6.9337</td>
      <td>8.1152</td>
      <td>8.3272</td>
      <td>8.0495</td>
      <td>9.6303</td>
      <td>8.3736</td>
      <td>9.0144</td>
      <td>9.8250</td>
      <td>9.5564</td>
      <td>8.4491</td>
      <td>9.3827</td>
      <td>9.7339</td>
      <td>7.6906</td>
      <td>8.7026</td>
      <td>6.5987</td>
      <td>8.8552</td>
      <td>7.3927</td>
      <td>8.3048</td>
      <td>7.3380</td>
      <td>7.7705</td>
      <td>8.6787</td>
      <td>7.9360</td>
      <td>8.1440</td>
      <td>8.2584</td>
      <td>7.6809</td>
      <td>6.7938</td>
      <td>10.2544</td>
      <td>8.6699</td>
      <td>6.8795</td>
      <td>7.6993</td>
      <td>8.0260</td>
      <td>7.6870</td>
      <td>9.1015</td>
      <td>7.9151</td>
      <td>7.7997</td>
      <td>8.4602</td>
      <td>9.3955</td>
      <td>9.3654</td>
      <td>7.1228</td>
      <td>10.1851</td>
      <td>8.9583</td>
      <td>8.6005</td>
      <td>9.1412</td>
      <td>8.2863</td>
      <td>9.0798</td>
      <td>9.8016</td>
      <td>8.4744</td>
      <td>7.2335</td>
      <td>8.1654</td>
      <td>9.1363</td>
      <td>7.8797</td>
      <td>8.3459</td>
      <td>8.1668</td>
      <td>8.8832</td>
      <td>9.6468</td>
      <td>9.1314</td>
      <td>8.0587</td>
      <td>8.6297</td>
      <td>8.7160</td>
      <td>7.9313</td>
      <td>8.2261</td>
      <td>8.4090</td>
      <td>7.5129</td>
      <td>8.0114</td>
      <td>6.7926</td>
      <td>7.5435</td>
      <td>7.5338</td>
      <td>8.4134</td>
      <td>9.6792</td>
      <td>9.4323</td>
      <td>9.0489</td>
      <td>8.3288</td>
      <td>7.7048</td>
      <td>8.5637</td>
      <td>8.3277</td>
      <td>8.5330</td>
      <td>8.9807</td>
      <td>8.9977</td>
      <td>8.2473</td>
      <td>9.6170</td>
      <td>7.6683</td>
      <td>7.3489</td>
      <td>7.9927</td>
      <td>7.1645</td>
      <td>8.9068</td>
      <td>8.3126</td>
      <td>7.8546</td>
      <td>7.8164</td>
      <td>7.7755</td>
      <td>9.0864</td>
      <td>8.3691</td>
      <td>7.6968</td>
      <td>9.3912</td>
      <td>9.6854</td>
      <td>9.1414</td>
      <td>8.3699</td>
      <td>7.2528</td>
      <td>7.3840</td>
      <td>8.3109</td>
      <td>7.9273</td>
      <td>8.9461</td>
      <td>9.0077</td>
      <td>9.9350</td>
      <td>8.1543</td>
      <td>8.1164</td>
      <td>8.5358</td>
      <td>9.3662</td>
      <td>8.7857</td>
      <td>7.2239</td>
      <td>8.3636</td>
      <td>7.7923</td>
      <td>8.2715</td>
      <td>8.4018</td>
      <td>8.0629</td>
      <td>7.7019</td>
      <td>8.0887</td>
      <td>8.0258</td>
      <td>7.4817</td>
      <td>8.4937</td>
      <td>8.3959</td>
      <td>7.6639</td>
      <td>8.4993</td>
      <td>8.4815</td>
      <td>7.8020</td>
      <td>9.0679</td>
      <td>9.0500</td>
      <td>9.1413</td>
      <td>8.1932</td>
      <td>8.8357</td>
      <td>8.7674</td>
      <td>8.1115</td>
      <td>7.1208</td>
      <td>8.8311</td>
      <td>8.8040</td>
      <td>8.6506</td>
      <td>7.1148</td>
      <td>7.9377</td>
      <td>8.2413</td>
      <td>8.8884</td>
      <td>7.3040</td>
      <td>8.5518</td>
      <td>8.7430</td>
      <td>8.8249</td>
      <td>7.8675</td>
      <td>7.9440</td>
      <td>8.9658</td>
      <td>9.2448</td>
      <td>6.9924</td>
      <td>7.9411</td>
      <td>7.4517</td>
      <td>8.9327</td>
      <td>7.2081</td>
      <td>8.2532</td>
      <td>8.2563</td>
      <td>7.7443</td>
      <td>8.7259</td>
      <td>9.3832</td>
      <td>8.8253</td>
      <td>8.0031</td>
      <td>8.2955</td>
      <td>8.2765</td>
      <td>7.8229</td>
      <td>8.6316</td>
      <td>8.5860</td>
      <td>6.9472</td>
      <td>8.3785</td>
      <td>8.4556</td>
      <td>9.1862</td>
      <td>7.5927</td>
      <td>8.6970</td>
      <td>5.8352</td>
      <td>7.6451</td>
      <td>9.2664</td>
      <td>8.0690</td>
      <td>8.7478</td>
      <td>7.4938</td>
      <td>8.7066</td>
      <td>9.4710</td>
      <td>9.3642</td>
      <td>7.7739</td>
      <td>8.0841</td>
      <td>8.1780</td>
      <td>7.4742</td>
      <td>8.6408</td>
      <td>8.6898</td>
      <td>7.7883</td>
      <td>8.4558</td>
      <td>9.1530</td>
      <td>10.1528</td>
      <td>8.5159</td>
      <td>9.8086</td>
      <td>9.7207</td>
      <td>7.6168</td>
      <td>8.8016</td>
      <td>7.8785</td>
      <td>8.5502</td>
      <td>8.8609</td>
      <td>8.8188</td>
      <td>6.1655</td>
      <td>8.1194</td>
      <td>7.5525</td>
      <td>8.4967</td>
      <td>7.3293</td>
      <td>8.9952</td>
      <td>8.4818</td>
      <td>9.1144</td>
      <td>7.1372</td>
      <td>8.1151</td>
      <td>8.3783</td>
      <td>7.9145</td>
      <td>8.7581</td>
      <td>8.7234</td>
      <td>8.6154</td>
      <td>8.4363</td>
      <td>8.5036</td>
      <td>6.9473</td>
      <td>8.7350</td>
      <td>9.5664</td>
      <td>7.9311</td>
      <td>7.4117</td>
      <td>8.5619</td>
      <td>7.7587</td>
      <td>9.8614</td>
      <td>9.5839</td>
      <td>9.6539</td>
      <td>8.6016</td>
      <td>8.4839</td>
      <td>8.4853</td>
      <td>7.8965</td>
      <td>8.7199</td>
      <td>9.0767</td>
      <td>7.6906</td>
      <td>7.8826</td>
      <td>8.7882</td>
      <td>8.3477</td>
      <td>8.9140</td>
      <td>9.6005</td>
      <td>8.8265</td>
      <td>6.7687</td>
      <td>8.6109</td>
      <td>9.0711</td>
      <td>8.1448</td>
      <td>9.3025</td>
      <td>9.5287</td>
      <td>9.0400</td>
      <td>9.1511</td>
      <td>8.6888</td>
      <td>7.5787</td>
      <td>7.6862</td>
      <td>9.4371</td>
      <td>8.6166</td>
      <td>8.6654</td>
      <td>7.1258</td>
      <td>8.8318</td>
      <td>7.7291</td>
      <td>7.0919</td>
      <td>8.4898</td>
      <td>8.6201</td>
      <td>9.6507</td>
      <td>8.3449</td>
      <td>7.9233</td>
      <td>7.3756</td>
      <td>7.0956</td>
      <td>8.0906</td>
      <td>7.5837</td>
      <td>9.4268</td>
      <td>8.7405</td>
      <td>8.4197</td>
      <td>9.1549</td>
      <td>8.5749</td>
      <td>6.7188</td>
      <td>7.2544</td>
      <td>8.5006</td>
      <td>8.2515</td>
      <td>9.3439</td>
      <td>7.7788</td>
      <td>9.3662</td>
      <td>7.7287</td>
      <td>7.9233</td>
      <td>9.7096</td>
      <td>8.2986</td>
      <td>8.7221</td>
      <td>8.4881</td>
      <td>9.5706</td>
      <td>8.3269</td>
      <td>9.1220</td>
      <td>7.3841</td>
      <td>7.6842</td>
      <td>8.9006</td>
      <td>8.1361</td>
      <td>8.7213</td>
      <td>8.9814</td>
      <td>8.3672</td>
      <td>7.7418</td>
      <td>7.4675</td>
      <td>8.0250</td>
      <td>8.5535</td>
      <td>8.8129</td>
      <td>8.5775</td>
      <td>9.0771</td>
      <td>7.9622</td>
      <td>7.5304</td>
      <td>7.6512</td>
      <td>8.9814</td>
      <td>8.5059</td>
      <td>9.0425</td>
      <td>8.6382</td>
      <td>7.6665</td>
      <td>9.1114</td>
      <td>8.6390</td>
      <td>7.8171</td>
      <td>8.0749</td>
      <td>7.9138</td>
      <td>7.9378</td>
      <td>8.5424</td>
      <td>8.6728</td>
      <td>8.9180</td>
      <td>8.5680</td>
      <td>8.4723</td>
      <td>8.2765</td>
      <td>9.7289</td>
      <td>7.1520</td>
      <td>8.3952</td>
      <td>9.6248</td>
      <td>7.8581</td>
      <td>9.5527</td>
      <td>7.6923</td>
      <td>9.2327</td>
      <td>7.5736</td>
      <td>8.4610</td>
      <td>7.8178</td>
      <td>7.9795</td>
      <td>8.2111</td>
      <td>8.0822</td>
      <td>7.2275</td>
      <td>9.7294</td>
      <td>8.3773</td>
      <td>7.8637</td>
      <td>8.7273</td>
      <td>7.0051</td>
      <td>8.8181</td>
      <td>8.4091</td>
      <td>9.6044</td>
      <td>9.5028</td>
      <td>7.9725</td>
      <td>7.9351</td>
      <td>8.9627</td>
      <td>9.6060</td>
      <td>9.2114</td>
      <td>8.3101</td>
      <td>8.3419</td>
      <td>10.1380</td>
      <td>9.0545</td>
      <td>8.7019</td>
      <td>7.3637</td>
      <td>9.0045</td>
      <td>7.8968</td>
      <td>8.2508</td>
      <td>8.2384</td>
      <td>8.0894</td>
      <td>8.1065</td>
      <td>8.5633</td>
      <td>7.7298</td>
      <td>9.3048</td>
      <td>10.0026</td>
      <td>8.2811</td>
      <td>8.7883</td>
      <td>8.0179</td>
      <td>7.8703</td>
      <td>8.8147</td>
    </tr>
    <tr>
      <th>FGR</th>
      <td>10.6173</td>
      <td>8.4858</td>
      <td>7.3211</td>
      <td>11.0656</td>
      <td>10.5213</td>
      <td>9.3386</td>
      <td>9.3440</td>
      <td>8.7403</td>
      <td>10.6243</td>
      <td>9.8945</td>
      <td>10.1067</td>
      <td>8.2663</td>
      <td>10.5393</td>
      <td>9.3087</td>
      <td>11.7055</td>
      <td>10.1633</td>
      <td>9.9218</td>
      <td>10.7935</td>
      <td>8.6680</td>
      <td>9.3646</td>
      <td>8.4917</td>
      <td>8.3683</td>
      <td>10.5502</td>
      <td>10.4143</td>
      <td>13.7653</td>
      <td>9.8602</td>
      <td>8.9363</td>
      <td>9.0198</td>
      <td>9.2149</td>
      <td>9.1690</td>
      <td>9.9654</td>
      <td>10.4230</td>
      <td>11.6101</td>
      <td>10.4511</td>
      <td>9.6184</td>
      <td>9.9466</td>
      <td>10.1096</td>
      <td>10.0554</td>
      <td>12.5322</td>
      <td>9.0607</td>
      <td>11.0522</td>
      <td>10.5198</td>
      <td>8.5024</td>
      <td>11.5016</td>
      <td>10.8670</td>
      <td>8.8416</td>
      <td>12.2780</td>
      <td>8.8244</td>
      <td>11.6315</td>
      <td>9.7211</td>
      <td>11.8538</td>
      <td>8.3346</td>
      <td>8.5788</td>
      <td>9.9279</td>
      <td>12.0813</td>
      <td>12.3180</td>
      <td>9.6880</td>
      <td>8.6507</td>
      <td>10.0116</td>
      <td>9.9325</td>
      <td>9.8269</td>
      <td>10.7108</td>
      <td>9.0030</td>
      <td>7.6588</td>
      <td>10.6705</td>
      <td>7.2463</td>
      <td>10.0586</td>
      <td>8.2823</td>
      <td>9.8099</td>
      <td>11.0707</td>
      <td>10.4863</td>
      <td>8.3067</td>
      <td>9.7500</td>
      <td>10.6279</td>
      <td>9.5733</td>
      <td>10.6769</td>
      <td>9.8680</td>
      <td>10.4574</td>
      <td>8.1190</td>
      <td>8.9752</td>
      <td>11.6027</td>
      <td>12.6021</td>
      <td>9.4494</td>
      <td>10.2858</td>
      <td>8.6901</td>
      <td>9.5814</td>
      <td>9.9495</td>
      <td>9.8711</td>
      <td>11.3526</td>
      <td>11.0880</td>
      <td>7.6519</td>
      <td>9.8892</td>
      <td>10.6668</td>
      <td>8.6482</td>
      <td>9.6278</td>
      <td>9.3992</td>
      <td>8.9880</td>
      <td>11.3194</td>
      <td>10.8624</td>
      <td>10.9816</td>
      <td>11.6053</td>
      <td>10.5979</td>
      <td>7.9816</td>
      <td>10.6734</td>
      <td>10.0487</td>
      <td>11.1478</td>
      <td>8.7977</td>
      <td>10.6032</td>
      <td>9.0852</td>
      <td>9.8649</td>
      <td>10.7973</td>
      <td>11.6060</td>
      <td>8.7619</td>
      <td>10.3262</td>
      <td>8.5420</td>
      <td>9.4730</td>
      <td>9.5663</td>
      <td>10.6520</td>
      <td>12.2258</td>
      <td>9.6665</td>
      <td>9.4678</td>
      <td>10.2449</td>
      <td>9.3221</td>
      <td>8.5334</td>
      <td>9.9490</td>
      <td>8.9464</td>
      <td>10.0200</td>
      <td>8.6182</td>
      <td>12.3758</td>
      <td>9.1607</td>
      <td>10.6504</td>
      <td>10.8448</td>
      <td>8.2533</td>
      <td>9.1937</td>
      <td>10.5314</td>
      <td>8.0932</td>
      <td>9.0344</td>
      <td>10.3383</td>
      <td>11.5452</td>
      <td>9.3794</td>
      <td>7.9106</td>
      <td>9.2890</td>
      <td>11.5038</td>
      <td>10.5689</td>
      <td>11.5897</td>
      <td>9.9777</td>
      <td>12.7109</td>
      <td>9.8607</td>
      <td>10.6532</td>
      <td>10.3516</td>
      <td>9.3908</td>
      <td>9.6290</td>
      <td>9.9126</td>
      <td>12.3441</td>
      <td>9.3238</td>
      <td>9.7591</td>
      <td>11.6668</td>
      <td>7.4797</td>
      <td>10.3716</td>
      <td>9.5435</td>
      <td>9.3356</td>
      <td>9.5930</td>
      <td>10.9491</td>
      <td>8.8594</td>
      <td>10.3561</td>
      <td>9.6110</td>
      <td>10.3872</td>
      <td>9.7308</td>
      <td>11.2202</td>
      <td>10.9032</td>
      <td>8.9799</td>
      <td>8.3602</td>
      <td>9.2764</td>
      <td>8.4090</td>
      <td>8.3675</td>
      <td>10.6002</td>
      <td>10.9577</td>
      <td>9.2030</td>
      <td>10.3880</td>
      <td>9.4056</td>
      <td>8.3870</td>
      <td>9.6441</td>
      <td>9.7136</td>
      <td>10.5115</td>
      <td>9.5767</td>
      <td>9.7196</td>
      <td>9.4578</td>
      <td>10.1899</td>
      <td>9.4236</td>
      <td>9.9364</td>
      <td>8.9602</td>
      <td>7.7962</td>
      <td>12.3873</td>
      <td>11.9105</td>
      <td>8.7270</td>
      <td>9.9545</td>
      <td>9.8101</td>
      <td>8.9173</td>
      <td>10.3324</td>
      <td>12.3838</td>
      <td>9.6721</td>
      <td>9.5631</td>
      <td>9.7512</td>
      <td>8.7838</td>
      <td>10.0118</td>
      <td>10.7761</td>
      <td>9.7616</td>
      <td>9.7293</td>
      <td>9.5544</td>
      <td>9.9237</td>
      <td>9.0296</td>
      <td>10.8014</td>
      <td>10.3112</td>
      <td>8.6518</td>
      <td>10.3076</td>
      <td>10.6595</td>
      <td>11.3323</td>
      <td>9.8601</td>
      <td>9.7748</td>
      <td>9.4944</td>
      <td>7.5205</td>
      <td>8.9309</td>
      <td>9.4078</td>
      <td>9.6848</td>
      <td>11.1939</td>
      <td>11.7875</td>
      <td>10.2860</td>
      <td>9.8802</td>
      <td>9.7145</td>
      <td>9.9715</td>
      <td>9.3146</td>
      <td>9.1964</td>
      <td>9.8973</td>
      <td>10.0729</td>
      <td>8.3242</td>
      <td>10.7904</td>
      <td>9.7788</td>
      <td>8.8759</td>
      <td>9.5566</td>
      <td>9.6591</td>
      <td>9.9914</td>
      <td>10.9376</td>
      <td>10.5745</td>
      <td>9.0358</td>
      <td>8.9110</td>
      <td>11.7532</td>
      <td>8.7806</td>
      <td>10.1075</td>
      <td>9.3523</td>
      <td>10.6877</td>
      <td>9.4762</td>
      <td>9.5429</td>
      <td>10.0884</td>
      <td>8.0550</td>
      <td>8.0269</td>
      <td>7.6216</td>
      <td>10.2748</td>
      <td>8.8910</td>
      <td>9.2807</td>
      <td>12.6989</td>
      <td>8.5133</td>
      <td>9.2839</td>
      <td>11.4400</td>
      <td>10.9657</td>
      <td>8.1342</td>
      <td>10.1091</td>
      <td>8.2446</td>
      <td>11.4480</td>
      <td>11.8178</td>
      <td>9.6027</td>
      <td>9.3934</td>
      <td>9.5944</td>
      <td>9.3491</td>
      <td>8.3665</td>
      <td>8.7138</td>
      <td>10.0874</td>
      <td>7.3313</td>
      <td>11.4358</td>
      <td>10.6241</td>
      <td>9.8658</td>
      <td>10.1871</td>
      <td>10.5421</td>
      <td>7.4162</td>
      <td>10.8045</td>
      <td>10.7947</td>
      <td>10.0003</td>
      <td>9.5008</td>
      <td>10.2772</td>
      <td>9.7556</td>
      <td>9.2886</td>
      <td>10.2222</td>
      <td>9.3398</td>
      <td>11.4583</td>
      <td>9.4793</td>
      <td>11.1001</td>
      <td>9.5743</td>
      <td>9.4919</td>
      <td>8.2160</td>
      <td>9.1174</td>
      <td>9.3648</td>
      <td>9.3430</td>
      <td>10.2621</td>
      <td>8.1118</td>
      <td>9.7819</td>
      <td>10.5958</td>
      <td>9.1164</td>
      <td>9.0904</td>
      <td>11.5633</td>
      <td>8.7876</td>
      <td>9.4450</td>
      <td>9.5219</td>
      <td>9.4730</td>
      <td>9.6956</td>
      <td>10.5655</td>
      <td>9.3805</td>
      <td>11.0442</td>
      <td>8.2006</td>
      <td>8.7170</td>
      <td>9.3075</td>
      <td>8.8891</td>
      <td>10.7038</td>
      <td>10.1909</td>
      <td>10.0962</td>
      <td>9.5766</td>
      <td>9.6280</td>
      <td>10.2669</td>
      <td>12.1436</td>
      <td>10.2015</td>
      <td>10.4543</td>
      <td>10.6049</td>
      <td>12.8714</td>
      <td>9.2953</td>
      <td>9.3366</td>
      <td>10.4120</td>
      <td>13.2448</td>
      <td>11.4904</td>
      <td>10.0490</td>
      <td>9.7272</td>
      <td>10.4148</td>
      <td>9.0093</td>
      <td>9.4597</td>
      <td>11.0705</td>
      <td>10.3704</td>
      <td>10.0069</td>
      <td>8.9187</td>
      <td>8.5024</td>
      <td>11.1808</td>
      <td>10.2892</td>
      <td>10.0072</td>
      <td>10.2733</td>
      <td>10.1902</td>
      <td>10.1827</td>
      <td>8.2901</td>
      <td>10.3673</td>
      <td>11.2238</td>
      <td>9.7679</td>
      <td>11.1662</td>
      <td>10.1624</td>
      <td>10.4986</td>
      <td>9.4949</td>
      <td>9.8046</td>
      <td>10.5421</td>
      <td>8.6035</td>
      <td>10.0874</td>
      <td>8.8794</td>
      <td>9.3127</td>
      <td>12.1308</td>
      <td>8.7331</td>
      <td>9.3541</td>
      <td>9.8539</td>
      <td>9.6341</td>
      <td>9.2426</td>
      <td>9.6600</td>
      <td>9.0266</td>
      <td>7.6209</td>
      <td>7.7846</td>
      <td>11.4869</td>
      <td>9.6619</td>
      <td>11.0722</td>
      <td>11.3274</td>
      <td>11.8255</td>
      <td>11.0363</td>
      <td>9.7664</td>
      <td>10.6127</td>
      <td>9.8380</td>
      <td>9.8804</td>
      <td>9.4436</td>
      <td>10.2768</td>
      <td>12.4871</td>
      <td>12.3841</td>
      <td>11.3146</td>
      <td>9.2367</td>
      <td>12.1103</td>
      <td>9.2876</td>
      <td>10.3038</td>
      <td>10.1554</td>
      <td>10.1882</td>
      <td>9.1459</td>
      <td>11.8745</td>
      <td>13.0418</td>
      <td>10.0448</td>
      <td>10.4839</td>
      <td>9.4837</td>
      <td>9.6713</td>
      <td>10.2333</td>
      <td>10.7622</td>
      <td>9.1548</td>
      <td>8.0891</td>
      <td>8.7510</td>
      <td>10.8129</td>
      <td>9.4356</td>
      <td>10.0938</td>
      <td>9.8184</td>
      <td>9.2556</td>
      <td>10.0784</td>
      <td>9.5976</td>
      <td>11.5936</td>
      <td>9.9069</td>
      <td>10.2541</td>
      <td>8.7086</td>
      <td>7.8255</td>
      <td>11.3981</td>
      <td>9.5923</td>
      <td>9.6872</td>
      <td>9.5713</td>
      <td>8.1365</td>
      <td>10.1498</td>
      <td>7.9491</td>
      <td>10.4613</td>
      <td>8.3216</td>
      <td>9.9512</td>
      <td>10.6102</td>
      <td>10.5580</td>
      <td>10.5036</td>
      <td>8.2208</td>
      <td>8.9027</td>
      <td>8.7322</td>
      <td>11.0152</td>
      <td>9.7544</td>
      <td>9.0746</td>
      <td>8.9877</td>
      <td>9.9202</td>
      <td>8.5830</td>
      <td>10.6752</td>
      <td>8.9076</td>
      <td>10.7197</td>
      <td>10.5941</td>
      <td>8.6956</td>
      <td>6.9987</td>
      <td>9.4047</td>
      <td>9.6932</td>
      <td>9.7027</td>
      <td>9.7226</td>
      <td>10.1130</td>
      <td>10.0054</td>
      <td>11.5320</td>
      <td>8.2472</td>
      <td>11.6150</td>
      <td>9.4476</td>
      <td>8.2822</td>
      <td>9.3303</td>
      <td>10.4898</td>
      <td>10.7294</td>
      <td>10.2548</td>
      <td>10.8896</td>
      <td>9.7065</td>
      <td>9.3320</td>
      <td>9.9604</td>
      <td>10.3624</td>
      <td>11.3919</td>
      <td>9.2426</td>
      <td>10.1716</td>
      <td>11.0515</td>
      <td>9.8812</td>
      <td>9.2150</td>
      <td>9.3057</td>
      <td>10.0473</td>
      <td>10.6724</td>
      <td>7.2922</td>
      <td>9.7134</td>
      <td>9.0199</td>
      <td>9.8077</td>
      <td>9.4394</td>
      <td>9.4059</td>
      <td>9.3254</td>
      <td>10.4796</td>
      <td>9.4242</td>
      <td>8.0340</td>
      <td>10.4030</td>
      <td>10.2213</td>
      <td>10.3702</td>
      <td>8.7169</td>
      <td>8.1769</td>
      <td>9.9471</td>
      <td>8.9532</td>
      <td>10.6328</td>
      <td>11.3029</td>
      <td>9.6115</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classes</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">tcga_gxp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">G_gxp_nodes_list</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span> <span class="c1"># loc grabs rows of specified gene symbols</span>
    <span class="k">if</span> <span class="n">tcqa_gxp_meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample</span><span class="p">,</span> <span class="s1">&#39;Smoked&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Smoker&#39;</span><span class="p">:</span>
        <span class="n">classes</span><span class="p">[</span><span class="n">sample</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;smoker&#39;</span>
    <span class="k">elif</span> <span class="n">tcqa_gxp_meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sample</span><span class="p">,</span> <span class="s1">&#39;Smoked&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Never&#39;</span><span class="p">:</span>
        <span class="n">classes</span><span class="p">[</span><span class="n">sample</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;control&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform GSEA</span>
<span class="n">gs_res</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">gsea</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tcga_gxp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">G_gxp_nodes_list</span><span class="p">],</span> <span class="n">gene_sets</span><span class="o">=</span><span class="n">gene_sets</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span> <span class="n">permutation_num</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;signal_to_noise&#39;</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">gs_res</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Term</th>
      <th>ES</th>
      <th>NES</th>
      <th>NOM p-val</th>
      <th>FDR q-val</th>
      <th>FWER p-val</th>
      <th>Tag %</th>
      <th>Gene %</th>
      <th>Lead_genes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gsea</td>
      <td>Toxoplasmosis</td>
      <td>0.672196</td>
      <td>1.87385</td>
      <td>0.017544</td>
      <td>0.131839</td>
      <td>0.05</td>
      <td>11/19</td>
      <td>14.33%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;ALOX5;HLA-DOA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gsea</td>
      <td>Influenza A</td>
      <td>0.708245</td>
      <td>1.7236</td>
      <td>0.117647</td>
      <td>0.477917</td>
      <td>0.11</td>
      <td>11/17</td>
      <td>14.33%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;CASP1;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gsea</td>
      <td>Th17 cell differentiation</td>
      <td>0.735164</td>
      <td>1.659187</td>
      <td>0.096154</td>
      <td>0.399637</td>
      <td>0.18</td>
      <td>10/16</td>
      <td>14.33%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>gsea</td>
      <td>Th1 and Th2 cell differentiation</td>
      <td>0.735164</td>
      <td>1.659187</td>
      <td>0.096154</td>
      <td>0.399637</td>
      <td>0.18</td>
      <td>10/16</td>
      <td>14.33%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gsea</td>
      <td>Human T-cell leukemia virus 1 infection</td>
      <td>0.645243</td>
      <td>1.649653</td>
      <td>0.083333</td>
      <td>0.323006</td>
      <td>0.18</td>
      <td>13/22</td>
      <td>18.67%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;SPI1;HLA-DOA;ITGB2;HLA-F</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terms</span> <span class="o">=</span> <span class="n">gs_res</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">Term</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">gs_res</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">terms</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">show_ranking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">0</span><span class="p">)},</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c00feafe91647bda1c6558ca58245ec86b152376fbebab0696a4ff68ed1605d7.png" src="../_images/c00feafe91647bda1c6558ca58245ec86b152376fbebab0696a4ff68ed1605d7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_res</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">Lead_genes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0                                                          HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;ALOX5;HLA-DOA
1                                                          HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;CASP1;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA
2                                                                HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA
3                                                                HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA
4                                               HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;SPI1;HLA-DOA;ITGB2;HLA-F
5                                                HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;NCF4;NCF2;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;ITGB2
6         HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;NCF4;NCF2;HLA-DQB1;HLA-DQA1;HLA-DRB5;MSR1;HLA-DOA;MARCO;ITGB2;HLA-F;MRC1;HLA-B;ITGAM;TLR4
7                                   HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;ITGB2;HLA-F;LAMA2;HLA-B;CD86
8                                           HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;ITGB2;ACP5;TLR4;CD86
9                                                      HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;BTK;HLA-DRB5;HLA-DOA;HLA-F
10                                                                       HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5
11                                     HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;CD37;CSF1R;ITGAM;CD4;CD34
12        HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;SELPLG;HLA-DQA1;HLA-DRB5;HLA-DOA;ITGB2;HLA-F;SPN;ITGA8;HLA-B;ITGAM;CD86;CD4;CD34
13                                                    HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;CD74;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;HLA-F
14                               HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;CD74;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;ITGB2;MRC1;LSP1;ITGAM;TLR4
15                                                    HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;CD74;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;HLA-F
16                                                         HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;HLA-F
17                                                         HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;HLA-F
18                                                         HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;HLA-F
19                                                         HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5;HLA-DOA;HLA-F
20                                                                HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;SELPLG;HLA-DQA1;HLA-DRB5
21                                                                                                    NCF4;NCF2;BTK;SPI1;TYROBP;TREM2;ACP5;CSF1R;SIRPA
22                                                                                       CASP1;NCF4;NCF2;SELPLG;ITGB2;ITGAM;TLR4;FPR3;FPR1;CYBB;FCGR2A
23    IL2RB;COL4A1;COL1A1;COL1A2;COL4A2;THBS2;COL6A3;ITGA11;VWF;IL2RG;ITGA4;IL7R;FLT4;PDGFRB;LAMA4;PIK3R5;PIK3AP1;PIK3CG;PDGFRA;TLR4;LAMA2;CSF1R;ITGA8
24                                                      CXCL9;CCL5;CXCL10;IL2RB;CCR5;IL2RG;IL7R;IL10RA;ACVRL1;CCR1;CSF2RB;TNFSF13B;IL33;CD4;IL16;CSF1R
25                                                                                                          HLA-F;PTGER4;ITGA8;LAMA2;HLA-B;HLA-C;HLA-A
26                                     COL4A1;COL1A1;COL1A2;COL4A2;THBS2;COL6A3;ITGA11;PRKCB;VWF;ITGA4;FLT4;PDGFRB;LAMA4;MYLK;PDGFRA;PARVG;LAMA2;ITGA8
27                                                                              STAT1;CXCL10;PRKCB;VWF;F13A1;C1QB;C5AR1;C3AR1;C1QA;C1QC;FCGR2A;CYBB;C7
28                                                                       SPI1;PTGER4;CSF1R;LAMA2;PDGFRA;CSF2RB;MMP2;EDNRB;LAMA4;PDGFRB;FLT4;IL7R;IL2RG
Name: Lead_genes, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gseapy</span> <span class="kn">import</span> <span class="n">heatmap</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">genes</span> <span class="o">=</span> <span class="n">gs_res</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">Lead_genes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">gs_res</span><span class="o">.</span><span class="n">heatmat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">genes</span><span class="p">],</span> <span class="n">z_score</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">terms</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">xtick_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">classes</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">()]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xtick_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
<img alt="../_images/a84afc4140b2ab7ce1ac90fc5e4d2180f15c950cdc806a777e53d205291cb15c.png" src="../_images/a84afc4140b2ab7ce1ac90fc5e4d2180f15c950cdc806a777e53d205291cb15c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">seaborn</span> <span class="kn">import</span> <span class="n">clustermap</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">genes</span> <span class="o">=</span> <span class="n">gs_res</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">Lead_genes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gs_res</span><span class="o">.</span><span class="n">heatmat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">genes</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">clustermap</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="c1"># gs_res.heatmat.loc[genes],</span>
    <span class="n">pivot_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">,</span>
    <span class="n">z_score</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">dendrogram_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">colors_ratio</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
    <span class="n">cbar_pos</span><span class="o">=</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="n">tree_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/717aec685b39aca5709559cafb20fd58e7a4f77a77c12e3e09ee9edd07365a85.png" src="../_images/717aec685b39aca5709559cafb20fd58e7a4f77a77c12e3e09ee9edd07365a85.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gseapy</span> <span class="kn">import</span> <span class="n">dotplot</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">dotplot</span><span class="p">(</span><span class="n">gs_res</span><span class="o">.</span><span class="n">res2d</span><span class="p">,</span>
             <span class="n">column</span><span class="o">=</span><span class="s2">&quot;FDR q-val&quot;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;KEGG_2021_Human&#39;</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span>
             <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c06d4fcc358689ae1d2fe318730154950cbdb1b77a709f4236556ea5048e955c.png" src="../_images/c06d4fcc358689ae1d2fe318730154950cbdb1b77a709f4236556ea5048e955c.png" />
</div>
</div>
</section>
<section id="gsea-on-clusters">
<h3>GSEA on clusters<a class="headerlink" href="#gsea-on-clusters" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">communityGSEA</span><span class="p">(</span><span class="n">genes</span><span class="p">,</span> <span class="n">gene_sets</span><span class="o">=</span><span class="s1">&#39;KEGG_2021_Human&#39;</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">):</span>

    <span class="n">gs_res</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">gsea</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">tcga_gxp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">genes</span><span class="p">],</span> <span class="n">gene_sets</span><span class="o">=</span><span class="n">gene_sets</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span> <span class="n">permutation_num</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;signal_to_noise&#39;</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
    <span class="k">return</span> <span class="n">gs_res</span>

<span class="c1"># Perform ORA for each community</span>
<span class="n">community1_gsea</span> <span class="o">=</span> <span class="n">communityGSEA</span><span class="p">(</span><span class="n">communities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">community2_gsea</span> <span class="o">=</span> <span class="n">communityGSEA</span><span class="p">(</span><span class="n">communities</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
<span class="n">community3_gsea</span> <span class="o">=</span> <span class="n">communityGSEA</span><span class="p">(</span><span class="n">communities</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">community1_gsea</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Term</th>
      <th>ES</th>
      <th>NES</th>
      <th>NOM p-val</th>
      <th>FDR q-val</th>
      <th>FWER p-val</th>
      <th>Tag %</th>
      <th>Gene %</th>
      <th>Lead_genes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gsea</td>
      <td>Epstein-Barr virus infection</td>
      <td>0.853817</td>
      <td>1.789511</td>
      <td>0.0</td>
      <td>0.324881</td>
      <td>0.14</td>
      <td>10/11</td>
      <td>16.83%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;HLA-DQA1;BTK;HLA-DRB5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gsea</td>
      <td>Leishmaniasis</td>
      <td>0.667361</td>
      <td>1.767749</td>
      <td>0.040816</td>
      <td>0.181183</td>
      <td>0.17</td>
      <td>11/18</td>
      <td>16.83%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;NCF4;NCF2;HLA-DQB1;HLA-DQA1;HLA-DRB5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>gsea</td>
      <td>Influenza A</td>
      <td>0.805713</td>
      <td>1.723862</td>
      <td>0.0</td>
      <td>0.191596</td>
      <td>0.2</td>
      <td>10/12</td>
      <td>16.83%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;CASP1;HLA-DPA1;HLA-DQB1;HLA-DQA1;HLA-DRB5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>gsea</td>
      <td>Phagosome</td>
      <td>0.595196</td>
      <td>1.717777</td>
      <td>0.041667</td>
      <td>0.149945</td>
      <td>0.21</td>
      <td>16/22</td>
      <td>34.65%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;NCF4;NCF2;HLA-DQB1;HLA-DQA1;HLA-DRB5;MSR1;HLA-DOA;MARCO;ITGB2;MRC1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gsea</td>
      <td>Cell adhesion molecules</td>
      <td>0.649813</td>
      <td>1.710744</td>
      <td>0.04</td>
      <td>0.127453</td>
      <td>0.22</td>
      <td>10/16</td>
      <td>16.83%</td>
      <td>HLA-DRB1;HLA-DMA;HLA-DPB1;HLA-DRA;HLA-DMB;HLA-DPA1;HLA-DQB1;SELPLG;HLA-DQA1;HLA-DRB5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terms</span> <span class="o">=</span> <span class="n">community1_gsea</span><span class="o">.</span><span class="n">res2d</span><span class="o">.</span><span class="n">Term</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">community1_gsea</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">terms</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">show_ranking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legend_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">0</span><span class="p">)},</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7fc1f16fb1d70904d906e0ded3bd518c36e938a5de872297aed46fcf8d44564b.png" src="../_images/7fc1f16fb1d70904d906e0ded3bd518c36e938a5de872297aed46fcf8d44564b.png" />
</div>
</div>
</section>
</section>
<section id="patient-network-analysis">
<h2>2. Patient Network Analysis<a class="headerlink" href="#patient-network-analysis" title="Link to this heading">#</a></h2>
<section id="clustering-on-individual-patient-networks">
<h3>2.1 Clustering on Individual Patient Networks<a class="headerlink" href="#clustering-on-individual-patient-networks" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">patient_gxp_communities</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">community</span><span class="o">.</span><span class="n">modularity_max</span><span class="o">.</span><span class="n">greedy_modularity_communities</span><span class="p">(</span><span class="n">G_patient_gxp</span><span class="p">)</span>
<span class="n">draw_communities</span><span class="p">(</span><span class="n">G_patient_gxp</span><span class="p">,</span> <span class="n">patient_gxp_communities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/619c1afa1b29dda1c78d57835a973e3e696cc3544af31e0d700a2e20134108e9.png" src="../_images/619c1afa1b29dda1c78d57835a973e3e696cc3544af31e0d700a2e20134108e9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">patient_dnam_communities</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">community</span><span class="o">.</span><span class="n">modularity_max</span><span class="o">.</span><span class="n">greedy_modularity_communities</span><span class="p">(</span><span class="n">G_patient_dnam</span><span class="p">)</span>
<span class="n">draw_communities</span><span class="p">(</span><span class="n">G_patient_dnam</span><span class="p">,</span> <span class="n">patient_dnam_communities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/af651c8089292c9a50fb4994a8c72fbd55c8a6f28323c834631f521c6ff127f8.png" src="../_images/af651c8089292c9a50fb4994a8c72fbd55c8a6f28323c834631f521c6ff127f8.png" />
</div>
</div>
</section>
<section id="similarity-network-fusion-snf">
<h3>2.2 Similarity Network Fusion (SNF)<a class="headerlink" href="#similarity-network-fusion-snf" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">snf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_k_neighbors</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">k_neighbors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">matrix</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Exclude the node itself</span>
        <span class="n">k_neighbors</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">neighbors</span>
    <span class="k">return</span> <span class="n">k_neighbors</span>

<span class="k">def</span> <span class="nf">plot_knn_network</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>  <span class="n">node_colours</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span> 

    <span class="c1"># Get k-nearest neighbors for each node (k=20 in this example)</span>
    <span class="n">k_neighbors</span> <span class="o">=</span> <span class="n">get_k_neighbors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>

    <span class="c1"># Create a NetworkX graph</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>

    <span class="c1"># Add nodes to the graph</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># Add edges based on the k-nearest neighbors</span>
    <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">neighbors</span> <span class="ow">in</span> <span class="n">k_neighbors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_colours</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="p">,</span> <span class="n">lab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">node_colours</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="p">:</span> 
        <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">))</span> <span class="c1"># mpatches</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">G</span><span class="p">,</span> <span class="n">k_neighbors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Get adjacency matrices</span>
<span class="c1"># G_patient_gxp_adj_matrix = nx.to_pandas_adjacency(G_patient_gxp, weight=&#39;weight&#39;)</span>
<span class="c1"># G_patient_dnam_adj_matrix = nx.to_pandas_adjacency(G_patient_dnam, weight=&#39;weight&#39;)</span>

<span class="c1"># Get overlapping nodes</span>
<span class="n">all_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">G_patient_gxp_nodes_list</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">G_patient_dnam_nodes_list</span><span class="p">))</span>

<span class="c1"># Create adjacency matrix for G_patient_gxp with overlapping nodes</span>
<span class="n">G_patient_gxp_adj_matrix</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">G_patient_gxp</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">all_idx</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="c1"># Create adjacency matrix for G_patient_dnam with overlapping nodes</span>
<span class="n">G_patient_dnam_adj_matrix</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">G_patient_dnam</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">all_idx</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_graphs</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># list of adjacency matrices</span>
<span class="n">full_graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G_patient_gxp_adj_matrix</span><span class="p">)</span>
<span class="n">full_graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G_patient_gxp_adj_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">adj</span> <span class="o">=</span> <span class="n">snf</span><span class="o">.</span><span class="n">snf</span><span class="p">(</span><span class="n">full_graphs</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> 
<span class="n">adj_snf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">adj</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">all_idx</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">all_idx</span><span class="p">)</span>

<span class="n">node_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">adj_snf</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> 
<span class="n">node_colour</span> <span class="o">=</span> <span class="n">tcqa_gxp_meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">adj_snf</span><span class="o">.</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;Smoked&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span><span class="n">wesanderson</span><span class="o">.</span><span class="n">FantasticFox2_5</span><span class="o">.</span><span class="n">hex_colors</span><span class="p">,</span> <span class="n">rename</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">G_snf</span><span class="p">,</span> <span class="n">k_neighbors</span> <span class="o">=</span> <span class="n">plot_knn_network</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span> <span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">tcqa_gxp_meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">adj_snf</span><span class="o">.</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;Smoked&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(),</span> <span class="n">node_colours</span><span class="o">=</span><span class="n">node_colour</span> <span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">network</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_edgelist</span><span class="p">(</span><span class="n">G_snf</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;from&#39;</span> <span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">]</span>
<span class="n">network</span><span class="p">[</span><span class="s1">&#39;from_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">node_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">network</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">]]</span>
<span class="n">network</span><span class="p">[</span><span class="s1">&#39;to_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">node_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">network</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]]</span>

<span class="c1"># network.to_csv()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fa1650b495a98868e4c56034fd207f110f93bb0b7fe81286b48267ca91af8205.png" src="../_images/fa1650b495a98868e4c56034fd207f110f93bb0b7fe81286b48267ca91af8205.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">snf_communities</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">community</span><span class="o">.</span><span class="n">modularity_max</span><span class="o">.</span><span class="n">greedy_modularity_communities</span><span class="p">(</span><span class="n">G_snf</span><span class="p">)</span>
<span class="n">draw_communities</span><span class="p">(</span><span class="n">G_snf</span><span class="p">,</span> <span class="n">snf_communities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2405cbffb6f43cd23632fe4a1fc5e3dca9d0279e32d95658cee8637c0eb4565e.png" src="../_images/2405cbffb6f43cd23632fe4a1fc5e3dca9d0279e32d95658cee8637c0eb4565e.png" />
</div>
</div>
</section>
</section>
<section id="optional-gsea-pre-rank-with-dna-methylation-data">
<h2>Optional: GSEA pre-rank with DNA methylation data<a class="headerlink" href="#optional-gsea-pre-rank-with-dna-methylation-data" title="Link to this heading">#</a></h2>
</section>
<section id="optional-create-protein-protein-interaction-ppi-network">
<h2>Optional: Create Protein-Protein Interaction (PPI) Network<a class="headerlink" href="#optional-create-protein-protein-interaction-ppi-network" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ewas_smoking</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;section2_data/smoking.tsv&#39;</span> <span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># https://www.ewascatalog.org/?trait=smoking</span>
<span class="n">ewas_smoking</span><span class="o">.</span><span class="n">columns</span>

<span class="n">gen_scot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;/Users/chaeeunlee/Documents/VSC_workspaces/ismb_2024_data/ISMB_GS_Data.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ewas_smoking</span> <span class="o">=</span> <span class="n">ewas_smoking</span><span class="p">[[</span><span class="s1">&#39;cpg&#39;</span><span class="p">,</span> <span class="s1">&#39;gene&#39;</span><span class="p">]]</span> <span class="c1"># Select only the &#39;cpg&#39; and &#39;gene&#39; columns.</span>
<span class="n">ewas_smoking</span> <span class="o">=</span> <span class="n">ewas_smoking</span><span class="p">[</span><span class="n">ewas_smoking</span><span class="p">[</span><span class="s1">&#39;gene&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span> <span class="c1"># Filter out rows with invalid gene names.</span>
<span class="n">ewas_smoking</span> <span class="o">=</span> <span class="n">ewas_smoking</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span> <span class="c1"># Remove duplicate rows from the dataframe to ensure each CpG site-gene pair is unique.</span>
<span class="n">ewas_smoking</span> <span class="o">=</span> <span class="n">ewas_smoking</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;cpg&#39;</span><span class="p">)</span> <span class="c1"># Set the &#39;cpg&#39; column as the index.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load and drop missing values from DNA methylation data w1 and w3 -&gt; two diff batches</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">gen_scot</span><span class="p">[</span><span class="s1">&#39;DNAm_w1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">w3</span> <span class="o">=</span> <span class="n">gen_scot</span><span class="p">[</span><span class="s1">&#39;DNAm_w3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">phenotypes</span> <span class="o">=</span> <span class="n">gen_scot</span><span class="p">[</span><span class="s1">&#39;Phenotypes&#39;</span><span class="p">]</span>

<span class="c1"># Identify common CpG sites present in both GenScot W1 and W3 data and another EWAS smoking dataset.</span>
<span class="n">common_cpg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">w1</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">w3</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">ewas_smoking</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">common_cpg</span><span class="p">]</span>  <span class="c1"># Filter W1 data to include only common CpG sites.</span>
<span class="n">w3</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">common_cpg</span><span class="p">]</span>  <span class="c1"># Filter W3 data similarly.</span>
<span class="n">ewas_smoking</span> <span class="o">=</span> <span class="n">ewas_smoking</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">common_cpg</span><span class="p">]</span>  <span class="c1"># Filter EWAS smoking data similarly.</span>

<span class="c1"># Helper function to categorize smoking status based on pack_years. -&gt; explain pack_years, examples</span>
<span class="k">def</span> <span class="nf">smoking_cat</span><span class="p">(</span><span class="n">pack_years</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pack_years</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># maybe a diff threshold</span>
        <span class="k">return</span> <span class="s1">&#39;Never&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Smoker&#39;</span>

<span class="c1"># Apply to GenScot phenotypes data.</span>
<span class="n">phenotypes</span><span class="p">[</span><span class="s1">&#39;Smoking&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phenotypes</span><span class="p">[</span><span class="s1">&#39;pack_years&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">smoking_cat</span><span class="p">)</span>

<span class="c1"># Prepare phenotype data for W1 cohort.</span>
<span class="n">phenotypes_w1</span> <span class="o">=</span> <span class="n">phenotypes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Sample_SentrixID&#39;</span><span class="p">)</span> 
<span class="n">phenotypes_w1</span> <span class="o">=</span> <span class="n">phenotypes_w1</span><span class="p">[</span><span class="n">phenotypes_w1</span><span class="p">[</span><span class="s1">&#39;Smoking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>  <span class="c1"># Drop entries without smoking data.</span>
<span class="n">phenotypes_w1</span> <span class="o">=</span> <span class="n">phenotypes_w1</span><span class="p">[</span><span class="n">phenotypes_w1</span><span class="p">[</span><span class="s1">&#39;Set&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;W1&#39;</span><span class="p">]</span>  <span class="c1"># Select only entries from W1 set.</span>

<span class="c1"># Align W1 methylation data and W1 phenotype data on common indices.</span>
<span class="n">common_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">w1</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">phenotypes_w1</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">common_idx</span><span class="p">]</span>  <span class="c1"># Select common columns for W1 methylation data.</span>
<span class="n">phenotypes_w1</span> <span class="o">=</span> <span class="n">phenotypes_w1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">common_idx</span><span class="p">]</span>  <span class="c1"># Select common indices for W1 phenotypes.</span>

<span class="c1"># Prepare phenotype data for W3 cohort similarly.</span>
<span class="n">phenotypes_w3</span> <span class="o">=</span> <span class="n">phenotypes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Sample_SentrixID&#39;</span><span class="p">)</span>
<span class="n">phenotypes_w3</span> <span class="o">=</span> <span class="n">phenotypes_w3</span><span class="p">[</span><span class="n">phenotypes_w3</span><span class="p">[</span><span class="s1">&#39;Smoking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
<span class="n">phenotypes_w3</span> <span class="o">=</span> <span class="n">phenotypes_w3</span><span class="p">[</span><span class="n">phenotypes_w3</span><span class="p">[</span><span class="s1">&#39;Set&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;W3&#39;</span><span class="p">]</span>

<span class="c1"># Align W3 methylation data and W3 phenotype data on common indices.</span>
<span class="n">common_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">w3</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">phenotypes_w3</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">w3</span> <span class="o">=</span> <span class="n">w3</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">common_idx</span><span class="p">]</span>
<span class="n">phenotypes_w3</span> <span class="o">=</span> <span class="n">phenotypes_w3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">common_idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="retrieve-ppi-data-from-stringdb">
<h3>Retrieve PPI data from StringDB<a class="headerlink" href="#retrieve-ppi-data-from-stringdb" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_PPIs</span><span class="p">(</span><span class="n">identifiers</span><span class="p">,</span> <span class="n">qtype</span><span class="o">=</span><span class="s2">&quot;get_network&quot;</span><span class="p">):</span>
    
    <span class="n">identifiers</span> <span class="o">=</span> <span class="s1">&#39;%0D&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">identifiers</span><span class="p">))</span>  <span class="c1"># Concatenate using &#39;%0D&#39; for the API query.</span>
    <span class="n">query_templates</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># &quot;get_string_id&quot;: f&quot;https://string-db.org/api/tsv-no-header/get_string_ids?identifiers={identifiers}&amp;species=9606&amp;format=only-ids&quot;,</span>
        <span class="s2">&quot;get_network&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://string-db.org/api/tsv/network?identifiers=</span><span class="si">{</span><span class="n">identifiers</span><span class="si">}</span><span class="s2">&amp;species=9606&quot;</span><span class="p">,</span>
        <span class="c1"># &quot;get_annotation&quot;: f&quot;https://string-db.org/api/json/functional_annotation?identifiers={identifiers}&quot;, # &amp;[optional_parameters]&quot;</span>
    <span class="p">}</span>
    
    <span class="n">query_url</span> <span class="o">=</span> <span class="n">query_templates</span><span class="p">[</span><span class="n">qtype</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">ul</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">query_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">get_stringdb_ids</span><span class="p">(</span><span class="n">identifiers</span><span class="p">,</span> <span class="n">return_list</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    
    <span class="n">identifiers</span> <span class="o">=</span> <span class="s1">&#39;%0D&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">identifiers</span><span class="p">))</span> <span class="c1"># Concatenate using &#39;%0D&#39; for the API query.</span>
    <span class="n">query_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://string-db.org/api/tsv-no-header/get_string_ids?identifiers=</span><span class="si">{</span><span class="n">identifiers</span><span class="si">}</span><span class="s2">&amp;species=9606&amp;format=only-ids&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">ul</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">query_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
    <span class="c1"># result = &#39;%0D&#39;.join(result)</span>
    
    <span class="k">return</span> <span class="n">result</span> <span class="k">if</span> <span class="n">return_list</span> <span class="k">else</span> <span class="s1">&#39;%0D&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PPIs related to the genes of interest derived from the EWAS smoking data.</span>
<span class="n">PPIs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># The genes are grouped, sorted by frequency, and the top 400 are selected.</span>
<span class="n">ewas_smoking_genes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ewas_smoking</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;gene&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Get String-DB IDs for the list of gene names.</span>
<span class="n">stringdb_ids</span> <span class="o">=</span> <span class="n">get_stringdb_ids</span><span class="p">(</span><span class="n">ewas_smoking_genes</span><span class="p">,</span> <span class="n">return_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Retrieve PPI data using the String-DB IDs.</span>
<span class="n">interactions</span> <span class="o">=</span> <span class="n">get_PPIs</span><span class="p">(</span><span class="n">stringdb_ids</span><span class="p">,</span> <span class="n">qtype</span><span class="o">=</span><span class="s2">&quot;get_network&quot;</span><span class="p">)</span>
<span class="n">interactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">interaction</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">interaction</span> <span class="ow">in</span> <span class="n">interactions</span><span class="p">]</span> <span class="c1"># Process the interaction data.</span>

<span class="c1"># Extract column names and create a DataFrame.</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="n">interactions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Assuming the first line contains header information.</span>
<span class="n">interactions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">interactions</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>  <span class="c1"># Exclude header from data rows.</span>

<span class="c1"># Remove any duplicate rows and reset the DataFrame index.</span>
<span class="n">interactions_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">interactions_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Concatenate with any existing interactions DataFrame to accumulate results.</span>
<span class="n">PPIs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">PPIs_df</span><span class="p">,</span> <span class="n">interactions_df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Display the top rows of the protein-protein interaction table.</span>
<span class="n">display</span><span class="p">(</span><span class="n">PPIs_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">PPIs_df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stringId_A</th>
      <th>stringId_B</th>
      <th>preferredName_A</th>
      <th>preferredName_B</th>
      <th>ncbiTaxonId</th>
      <th>score</th>
      <th>nscore</th>
      <th>fscore</th>
      <th>pscore</th>
      <th>ascore</th>
      <th>escore</th>
      <th>dscore</th>
      <th>tscore</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9606.ENSP00000206513</td>
      <td>9606.ENSP00000496959</td>
      <td>CEBPE</td>
      <td>ITGAM</td>
      <td>9606</td>
      <td>0.455</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.123</td>
      <td>0.048</td>
      <td>0</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9606.ENSP00000206513</td>
      <td>9606.ENSP00000368632</td>
      <td>CEBPE</td>
      <td>GATA3</td>
      <td>9606</td>
      <td>0.473</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.091</td>
      <td>0</td>
      <td>0.444</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9606.ENSP00000206513</td>
      <td>9606.ENSP00000345344</td>
      <td>CEBPE</td>
      <td>CTSL</td>
      <td>9606</td>
      <td>0.528</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.104</td>
      <td>0</td>
      <td>0</td>
      <td>0.495</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9606.ENSP00000206513</td>
      <td>9606.ENSP00000294702</td>
      <td>CEBPE</td>
      <td>GFI1</td>
      <td>9606</td>
      <td>0.638</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.126</td>
      <td>0.091</td>
      <td>0</td>
      <td>0.581</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9606.ENSP00000206513</td>
      <td>9606.ENSP00000254066</td>
      <td>CEBPE</td>
      <td>RARA</td>
      <td>9606</td>
      <td>0.863</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.057</td>
      <td>0.045</td>
      <td>0.75</td>
      <td>0.465</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 272 entries, 0 to 271
Data columns (total 13 columns):
 #   Column           Non-Null Count  Dtype 
---  ------           --------------  ----- 
 0   stringId_A       272 non-null    object
 1   stringId_B       272 non-null    object
 2   preferredName_A  272 non-null    object
 3   preferredName_B  272 non-null    object
 4   ncbiTaxonId      272 non-null    object
 5   score            272 non-null    object
 6   nscore           272 non-null    object
 7   fscore           272 non-null    object
 8   pscore           272 non-null    object
 9   ascore           272 non-null    object
 10  escore           272 non-null    object
 11  dscore           272 non-null    object
 12  tscore           272 non-null    object
dtypes: object(13)
memory usage: 27.8+ KB
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make sure PPIs returned from String-DB correspond to the genes in the EWAS smoking data.</span>
<span class="n">gene_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ewas_smoking</span><span class="p">[</span><span class="s1">&#39;gene&#39;</span><span class="p">])</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">PPIs_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;preferredName_A&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">gene_set</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;preferredName_B&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">gene_set</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">PPIs_df</span> <span class="o">=</span> <span class="n">PPIs_df</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="n">PPIs_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-ppi-network">
<h3>Create PPI Network<a class="headerlink" href="#create-ppi-network" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>  <span class="c1"># Import the networkx library to handle graph operations</span>

<span class="c1"># Create an empty graph</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>

<span class="c1"># Add nodes to the graph</span>
<span class="c1"># We extract unique names from both &#39;preferredName_A&#39; and &#39;preferredName_B&#39; and add them as nodes in the graph.</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">PPIs_df</span><span class="p">[</span><span class="s1">&#39;preferredName_A&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">PPIs_df</span><span class="p">[</span><span class="s1">&#39;preferredName_B&#39;</span><span class="p">]))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

<span class="c1"># Add edges to the graph</span>
<span class="c1"># We create a list of tuples where each tuple represents a connection (edge) between two nodes.</span>
<span class="n">edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">PPIs_df</span><span class="p">[</span><span class="s1">&#39;preferredName_A&#39;</span><span class="p">],</span> <span class="n">PPIs_df</span><span class="p">[</span><span class="s1">&#39;preferredName_B&#39;</span><span class="p">]))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>  <span class="c1"># Add all edges to the network</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_network</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)):</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    
    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">draw_network</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4cc8d52be619063a88c15e94619bb794d6c0def6b7086534c5ef0b23c46599ef.png" src="../_images/4cc8d52be619063a88c15e94619bb794d6c0def6b7086534c5ef0b23c46599ef.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Section2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Section2_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction to Network Analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Section3_intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><font color='darkblue'><u> Introduction to Graph Neural Networks </font></u></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-datasets">0. Load Datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#molecular-network-analysis-with-g-exp">1. Molecular Network Analysis with <code class="docutils literal notranslate"><span class="pre">G_exp</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#over-representation-analysis-ora">1.1 Over Representation Analysis (ORA)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ora-before-clustering">1.1.1 ORA before clustering</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ora-after-clustering">1.1.1 ORA after clustering</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gene-set-enrichment-analysis-gsea">1.2 Gene Set Enrichment Analysis (GSEA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gsea-on-clusters">GSEA on clusters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#patient-network-analysis">2. Patient Network Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-on-individual-patient-networks">2.1 Clustering on Individual Patient Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#similarity-network-fusion-snf">2.2 Similarity Network Fusion (SNF)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-gsea-pre-rank-with-dna-methylation-data">Optional: GSEA pre-rank with DNA methylation data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-create-protein-protein-interaction-ppi-network">Optional: Create Protein-Protein Interaction (PPI) Network</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-ppi-data-from-stringdb">Retrieve PPI data from StringDB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-ppi-network">Create PPI Network</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>